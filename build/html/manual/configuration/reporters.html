

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reporters &mdash; buildbot-translate 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> buildbot-translate
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">1. Buildbot Tutorial</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">buildbot-translate</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Reporters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/manual/configuration/reporters.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="reporters">
<span id="id1"></span><h1>Reporters<a class="headerlink" href="#reporters" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#mailnotifier" id="id42">MailNotifier</a></p>
<ul>
<li><p><a class="reference internal" href="#mailnotifier-arguments" id="id43">MailNotifier arguments</a></p></li>
<li><p><a class="reference internal" href="#messageformatter-arguments" id="id44">MessageFormatter arguments</a></p></li>
<li><p><a class="reference internal" href="#messageformattermissingworkers-arguments" id="id45">MessageFormatterMissingWorkers arguments</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#pushover-notifications" id="id46">Pushover Notifications</a></p></li>
<li><p><a class="reference internal" href="#pushjet-notifications" id="id47">Pushjet Notifications</a></p></li>
<li><p><a class="reference internal" href="#irc-bot" id="id48">IRC Bot</a></p></li>
<li><p><a class="reference internal" href="#telegram-bot" id="id49">Telegram Bot</a></p></li>
<li><p><a class="reference internal" href="#gerritstatuspush" id="id50">GerritStatusPush</a></p></li>
<li><p><a class="reference internal" href="#httpstatuspush" id="id51">HttpStatusPush</a></p>
<ul>
<li><p><a class="reference internal" href="#json-object-spec" id="id52">Json object spec</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#githubstatuspush" id="id53">GitHubStatusPush</a></p></li>
<li><p><a class="reference internal" href="#githubcommentpush" id="id54">GitHubCommentPush</a></p></li>
<li><p><a class="reference internal" href="#bitbucketserverstatuspush" id="id55">BitbucketServerStatusPush</a></p></li>
<li><p><a class="reference internal" href="#bitbucketserverprcommentpush" id="id56">BitbucketServerPRCommentPush</a></p></li>
<li><p><a class="reference internal" href="#bitbucketstatuspush" id="id57">BitbucketStatusPush</a></p></li>
<li><p><a class="reference internal" href="#gitlabstatuspush" id="id58">GitLabStatusPush</a></p></li>
<li><p><a class="reference internal" href="#hipchatstatuspush" id="id59">HipchatStatusPush</a></p>
<ul>
<li><p><a class="reference internal" href="#id37" id="id60">Json object spec</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gerritverifystatuspush" id="id61">GerritVerifyStatusPush</a></p></li>
<li><p><a class="reference internal" href="#zulipstatuspush" id="id62">ZulipStatusPush</a></p>
<ul>
<li><p><a class="reference internal" href="#id41" id="id63">Json object spec</a></p></li>
</ul>
</li>
</ul>
</div>
<p>The Buildmaster has a variety of ways to present build status to various users.
Each such delivery method is a <cite>Reporter Target</cite> object in the configuration’s <code class="docutils literal notranslate"><span class="pre">services</span></code> list.
To add reporter targets, you just append more objects to this list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">MailNotifier</span><span class="p">(</span><span class="n">fromaddr</span><span class="o">=</span><span class="s2">&quot;buildbot@localhost&quot;</span><span class="p">,</span>
                           <span class="n">extraRecipients</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;builds@lists.example.com&quot;</span><span class="p">],</span>
                           <span class="n">sendToInterestedUsers</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reporters</span><span class="o">.</span><span class="n">IRC</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;irc.example.com&quot;</span><span class="p">,</span> <span class="n">nick</span><span class="o">=</span><span class="s2">&quot;bb&quot;</span><span class="p">,</span>
                                  <span class="n">channels</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;channel&quot;</span><span class="p">:</span> <span class="s2">&quot;#example1&quot;</span><span class="p">},</span>
                                            <span class="p">{</span><span class="s2">&quot;channel&quot;</span><span class="p">:</span> <span class="s2">&quot;#example2&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;somesecretpassword&quot;</span><span class="p">}]))</span>
</pre></div>
</div>
<p>Most reporter objects take a <code class="docutils literal notranslate"><span class="pre">tags=</span></code> argument, which can contain a list of tag names: in this case, it will only show status for Builders that contains the named tags.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Implementation Note</p>
<p>Each of these objects should be a <code class="xref py py-class docutils literal notranslate"><span class="pre">service.BuildbotService</span></code> which will be attached to the BuildMaster object when the configuration is processed.</p>
</div>
<p>The remainder of this section describes each built-in reporters.
A full list of reporters is available in the <a href="#id2"><span class="problematic" id="id3">:bb:index:`reporter`</span></a>.</p>
<div class="section" id="mailnotifier">
<span id="index-0"></span><h2><a class="toc-backref" href="#id42">MailNotifier</a><a class="headerlink" href="#mailnotifier" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.mail.MailNotifier">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.mail.</code><code class="sig-name descname">MailNotifier</code><a class="headerlink" href="#buildbot.reporters.mail.MailNotifier" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The Buildbot can send email when builds finish.
The most common use of this is to tell developers when their change has caused the build to fail.
It is also quite common to send a message to a mailing list (usually named <cite>builds</cite> or similar) about every build.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">MailNotifier</span></code> reporter is used to accomplish this.
You configure it by specifying who mail should be sent to, under what circumstances mail should be sent, and how to deliver the mail.
It can be configured to only send out mail for certain builders, and only send messages when the build fails, or when the builder transitions from success to failure.
It can also be configured to include various build logs in each message.</p>
<p>If a proper lookup function is configured, the message will be sent to the “interested users” list (<a class="reference internal" href="../concepts.html#doing-things-with-users"><span class="std std-ref">Doing Things With Users</span></a>), which includes all developers who made changes in the build.
By default, however, Buildbot does not know how to construct an email addressed based on the information from the version control system.
See the <code class="docutils literal notranslate"><span class="pre">lookup</span></code> argument, below, for more information.</p>
<p>You can add additional, statically-configured, recipients with the <code class="docutils literal notranslate"><span class="pre">extraRecipients</span></code> argument.
You can also add interested users by setting the <code class="docutils literal notranslate"><span class="pre">owners</span></code> build property to a list of users in the scheduler constructor (<a class="reference internal" href="schedulers.html#configuring-schedulers"><span class="std std-ref">Configuring Schedulers</span></a>).</p>
<p>Each <code class="xref py py-class docutils literal notranslate"><span class="pre">MailNotifier</span></code> sends mail to a single set of recipients.
To send different kinds of mail to different recipients, use multiple <code class="xref py py-class docutils literal notranslate"><span class="pre">MailNotifier</span></code>s.
TODO: or subclass MailNotifier and override getRecipients()</p>
<p>The following simple example will send an email upon the completion of each build, to just those developers whose <code class="xref py py-class docutils literal notranslate"><span class="pre">Change</span></code>s were included in the build.
The email contains a description of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Build</span></code>, its results, and URLs where more information can be obtained.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>
<span class="n">mn</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">MailNotifier</span><span class="p">(</span><span class="n">fromaddr</span><span class="o">=</span><span class="s2">&quot;buildbot@example.org&quot;</span><span class="p">,</span>
                            <span class="n">lookup</span><span class="o">=</span><span class="s2">&quot;example.org&quot;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mn</span><span class="p">)</span>
</pre></div>
</div>
<p>To get a simple one-message-per-build (say, for a mailing list), use the following form instead.
This form does not send mail to individual developers (and thus does not need the <code class="docutils literal notranslate"><span class="pre">lookup=</span></code> argument, explained below), instead it only ever sends mail to the <cite>extra recipients</cite> named in the arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mn</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">MailNotifier</span><span class="p">(</span><span class="n">fromaddr</span><span class="o">=</span><span class="s2">&quot;buildbot@example.org&quot;</span><span class="p">,</span>
                            <span class="n">sendToInterestedUsers</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                            <span class="n">extraRecipients</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;listaddr@example.org&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>If your SMTP host requires authentication before it allows you to send emails, this can also be done by specifying <code class="docutils literal notranslate"><span class="pre">smtpUser</span></code> and <code class="docutils literal notranslate"><span class="pre">smtpPassword</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mn</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">MailNotifier</span><span class="p">(</span><span class="n">fromaddr</span><span class="o">=</span><span class="s2">&quot;myuser@example.com&quot;</span><span class="p">,</span>
                            <span class="n">sendToInterestedUsers</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                            <span class="n">extraRecipients</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;listaddr@example.org&quot;</span><span class="p">],</span>
                            <span class="n">relayhost</span><span class="o">=</span><span class="s2">&quot;smtp.example.com&quot;</span><span class="p">,</span> <span class="n">smtpPort</span><span class="o">=</span><span class="mi">587</span><span class="p">,</span>
                            <span class="n">smtpUser</span><span class="o">=</span><span class="s2">&quot;myuser@example.com&quot;</span><span class="p">,</span>
                            <span class="n">smtpPassword</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If for some reasons you are not able to send a notification with TLS enabled and specified user name and password, you might want to use <a href="#id4"><span class="problematic" id="id5">:contrib-src:`master/contrib/check_smtp.py`</span></a> to see if it works at all.</p>
</div>
<p>If you want to require Transport Layer Security (TLS), then you can also set <code class="docutils literal notranslate"><span class="pre">useTls</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mn</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">MailNotifier</span><span class="p">(</span><span class="n">fromaddr</span><span class="o">=</span><span class="s2">&quot;myuser@example.com&quot;</span><span class="p">,</span>
                            <span class="n">sendToInterestedUsers</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                            <span class="n">extraRecipients</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;listaddr@example.org&quot;</span><span class="p">],</span>
                            <span class="n">useTls</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">relayhost</span><span class="o">=</span><span class="s2">&quot;smtp.example.com&quot;</span><span class="p">,</span>
                            <span class="n">smtpPort</span><span class="o">=</span><span class="mi">587</span><span class="p">,</span> <span class="n">smtpUser</span><span class="o">=</span><span class="s2">&quot;myuser@example.com&quot;</span><span class="p">,</span>
                            <span class="n">smtpPassword</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you see <code class="docutils literal notranslate"><span class="pre">twisted.mail.smtp.TLSRequiredError</span></code> exceptions in the log while using TLS, this can be due <em>either</em> to the server not supporting TLS or to a missing <a class="reference external" href="http://pyopenssl.sourceforge.net/">PyOpenSSL</a> package on the BuildMaster system.</p>
</div>
<p>In some cases it is desirable to have different information then what is provided in a standard MailNotifier message.
For this purpose MailNotifier provides the argument <code class="docutils literal notranslate"><span class="pre">messageFormatter</span></code> (an instance of <code class="docutils literal notranslate"><span class="pre">MessageFormatter</span></code>) which allows for the creation of messages with unique content.</p>
<p>For example, if only short emails are desired (e.g., for delivery to phones):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>
<span class="n">mn</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">MailNotifier</span><span class="p">(</span>
    <span class="n">fromaddr</span><span class="o">=</span><span class="s2">&quot;buildbot@example.org&quot;</span><span class="p">,</span>
    <span class="n">sendToInterestedUsers</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;problem&#39;</span><span class="p">,),</span>
    <span class="n">extraRecipients</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;listaddr@example.org&#39;</span><span class="p">],</span>
    <span class="n">messageFormatter</span><span class="o">=</span><span class="n">reporters</span><span class="o">.</span><span class="n">MessageFormatter</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;STATUS: {{ summary }}&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Another example of a function delivering a customized html email is given below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>

<span class="n">template</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;&#39;</span><span class="se">\</span>
<span class="s1">&lt;h4&gt;Build status: {{ summary }}&lt;/h4&gt;</span>
<span class="s1">&lt;p&gt; Worker used: {{ workername }}&lt;/p&gt;</span>
<span class="s1">{</span><span class="si">% f</span><span class="s1">or step in build[&#39;steps&#39;] %}</span>
<span class="s1">&lt;p&gt; {{ step[&#39;name&#39;] }}: {{ step[&#39;results&#39;] }}&lt;/p&gt;</span>
<span class="s1">{</span><span class="si">% e</span><span class="s1">ndfor %}</span>
<span class="s1">&lt;p&gt;&lt;b&gt; -- The Buildbot&lt;/b&gt;&lt;/p&gt;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">mn</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">MailNotifier</span><span class="p">(</span><span class="n">fromaddr</span><span class="o">=</span><span class="s2">&quot;buildbot@example.org&quot;</span><span class="p">,</span>
                            <span class="n">sendToInterestedUsers</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                            <span class="n">mode</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;failing&#39;</span><span class="p">,),</span>
                            <span class="n">extraRecipients</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;listaddr@example.org&#39;</span><span class="p">],</span>
                            <span class="n">messageFormatter</span><span class="o">=</span><span class="n">reporters</span><span class="o">.</span><span class="n">MessageFormatter</span><span class="p">(</span>
                                <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span> <span class="n">template_type</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">,</span>
                                <span class="n">wantProperties</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">wantSteps</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="mailnotifier-arguments">
<h3><a class="toc-backref" href="#id43">MailNotifier arguments</a><a class="headerlink" href="#mailnotifier-arguments" title="Permalink to this headline">¶</a></h3>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">fromaddr</span></code></dt><dd><p>The email address to be used in the ‘From’ header.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">sendToInterestedUsers</span></code></dt><dd><p>(boolean).
If <code class="docutils literal notranslate"><span class="pre">True</span></code> (the default), send mail to all of the Interested Users.
Interested Users are authors of changes and users from the <code class="docutils literal notranslate"><span class="pre">owners</span></code> build property.
Override <code class="docutils literal notranslate"><span class="pre">MailNotifier</span></code> <code class="docutils literal notranslate"><span class="pre">getResponsibleUsersForBuild</span></code> method to change that.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, only send mail to the <code class="docutils literal notranslate"><span class="pre">extraRecipients</span></code> list.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">extraRecipients</span></code></dt><dd><p>(list of strings).
A list of email addresses to which messages should be sent (in addition to the InterestedUsers list, which includes any developers who made <code class="xref py py-class docutils literal notranslate"><span class="pre">Change</span></code>s that went into this build).
It is a good idea to create a small mailing list and deliver to that, then let subscribers come and go as they please.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">subject</span></code></dt><dd><p>(string).
A string to be used as the subject line of the message.
<code class="docutils literal notranslate"><span class="pre">%(builder)s</span></code> will be replaced with the name of the builder which provoked the message.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">mode</span></code></dt><dd><p>Mode is a list of strings; however there are two strings which can be used as shortcuts instead of the full lists.
The possible shortcuts are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">all</span></code></dt><dd><p>Always send mail about builds.
Equivalent to (<code class="docutils literal notranslate"><span class="pre">change</span></code>, <code class="docutils literal notranslate"><span class="pre">failing</span></code>, <code class="docutils literal notranslate"><span class="pre">passing</span></code>, <code class="docutils literal notranslate"><span class="pre">problem</span></code>, <code class="docutils literal notranslate"><span class="pre">warnings</span></code>, <code class="docutils literal notranslate"><span class="pre">exception</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">warnings</span></code></dt><dd><p>Equivalent to (<code class="docutils literal notranslate"><span class="pre">warnings</span></code>, <code class="docutils literal notranslate"><span class="pre">failing</span></code>).</p>
</dd>
</dl>
<p>Set these shortcuts as actual strings in the configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>
<span class="n">mn</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">MailNotifier</span><span class="p">(</span><span class="n">fromaddr</span><span class="o">=</span><span class="s2">&quot;buildbot@example.org&quot;</span><span class="p">,</span>
                            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;warnings&quot;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mn</span><span class="p">)</span>
</pre></div>
</div>
<p>(list of strings).
A combination of:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">cancelled</span></code></dt><dd><p>Send mail about builds which were cancelled.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">change</span></code></dt><dd><p>Send mail about builds which change status.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">failing</span></code></dt><dd><p>Send mail about builds which fail.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">passing</span></code></dt><dd><p>Send mail about builds which succeed.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">problem</span></code></dt><dd><p>Send mail about a build which failed when the previous build has passed.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">warnings</span></code></dt><dd><p>Send mail about builds which generate warnings.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">exception</span></code></dt><dd><p>Send mail about builds which generate exceptions.</p>
</dd>
</dl>
<p>Defaults to (<code class="docutils literal notranslate"><span class="pre">failing</span></code>, <code class="docutils literal notranslate"><span class="pre">passing</span></code>, <code class="docutils literal notranslate"><span class="pre">warnings</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">builders</span></code></dt><dd><p>(list of strings).
A list of builder names for which mail should be sent.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> (send mail for all builds).
Use either builders or tags, but not both.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tags</span></code></dt><dd><p>(list of strings).
A list of tag names to serve status information for.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> (all tags).
Use either builders or tags, but not both.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">schedulers</span></code></dt><dd><p>(list of strings).
A list of scheduler names to serve status information for.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> (all schedulers).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">branches</span></code></dt><dd><p>(list of strings).
A list of branch names to serve status information for.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> (all branches).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">addLogs</span></code></dt><dd><p>(boolean).
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, include all build logs as attachments to the messages.
These can be quite large.
This can also be set to a list of log names, to send a subset of the logs.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">addPatch</span></code></dt><dd><p>(boolean).
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, include the patch content if a patch was present.
Patches are usually used on a <code class="xref py py-class docutils literal notranslate"><span class="pre">Try</span></code> server.
Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">buildSetSummary</span></code></dt><dd><p>(boolean).
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, send a single summary email consisting of the concatenation of all build completion messages rather than a completion message for each build.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">relayhost</span></code></dt><dd><p>(string).
The host to which the outbound SMTP connection should be made.
Defaults to ‘localhost’</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">smtpPort</span></code></dt><dd><p>(int).
The port that will be used on outbound SMTP connections.
Defaults to 25.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">useTls</span></code></dt><dd><p>(boolean).
When this argument is <code class="docutils literal notranslate"><span class="pre">True</span></code> (default is <code class="docutils literal notranslate"><span class="pre">False</span></code>) <code class="docutils literal notranslate"><span class="pre">MailNotifier</span></code> requires that STARTTLS encryption is used for the connection with the <code class="docutils literal notranslate"><span class="pre">relayhost</span></code>.
Authentication is required for STARTTLS so the arguments <code class="docutils literal notranslate"><span class="pre">smtpUser</span></code> and <code class="docutils literal notranslate"><span class="pre">smtpPassword</span></code> must also be specified.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">useSmtps</span></code></dt><dd><p>(boolean).
When this argument is <code class="docutils literal notranslate"><span class="pre">True</span></code> (default is <code class="docutils literal notranslate"><span class="pre">False</span></code>) <code class="docutils literal notranslate"><span class="pre">MailNotifier</span></code> connects to <code class="docutils literal notranslate"><span class="pre">relayhost</span></code> over an encrypted SSL/TLS connection.
This configuration is typically used over port 465.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">smtpUser</span></code></dt><dd><p>(string).
The user name to use when authenticating with the <code class="docutils literal notranslate"><span class="pre">relayhost</span></code>.
Can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">smtpPassword</span></code></dt><dd><p>(string).
The password that will be used when authenticating with the <code class="docutils literal notranslate"><span class="pre">relayhost</span></code>.
Can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">lookup</span></code></dt><dd><p>(implementer of <code class="xref py py-class docutils literal notranslate"><span class="pre">IEmailLookup</span></code>).
Object which provides <code class="xref py py-class docutils literal notranslate"><span class="pre">IEmailLookup</span></code>, which is responsible for mapping User names (which come from the VC system) into valid email addresses.</p>
<p>If the argument is not provided, the <code class="docutils literal notranslate"><span class="pre">MailNotifier</span></code> will attempt to build the <code class="docutils literal notranslate"><span class="pre">sendToInterestedUsers</span></code> from the authors of the Changes that led to the Build via <a class="reference internal" href="../concepts.html#user-objects"><span class="std std-ref">User Objects</span></a>.
If the author of one of the Build’s Changes has an email address stored, it will added to the recipients list.
With this method, <code class="docutils literal notranslate"><span class="pre">owners</span></code> are still added to the recipients.
Note that, in the current implementation of user objects, email addresses are not stored; as a result, unless you have specifically added email addresses to the user database, this functionality is unlikely to actually send any emails.</p>
<p>Most of the time you can use a simple Domain instance.
As a shortcut, you can pass as string: this will be treated as if you had provided <code class="docutils literal notranslate"><span class="pre">Domain(str)</span></code>.
For example, <code class="docutils literal notranslate"><span class="pre">lookup='example.com'</span></code> will allow mail to be sent to all developers whose SVN usernames match their <code class="docutils literal notranslate"><span class="pre">example.com</span></code> account names.
See <a href="#id6"><span class="problematic" id="id7">:src:`master/buildbot/reporters/mail.py`</span></a> for more details.</p>
<p>Regardless of the setting of <code class="docutils literal notranslate"><span class="pre">lookup</span></code>, <code class="docutils literal notranslate"><span class="pre">MailNotifier</span></code> will also send mail to addresses in the <code class="docutils literal notranslate"><span class="pre">extraRecipients</span></code> list.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">messageFormatter</span></code></dt><dd><p>This is an optional instance of the <code class="docutils literal notranslate"><span class="pre">reporters.MessageFormatter</span></code> class that can be used to generate a custom mail message.
This class uses the <a class="reference external" href="http://jinja.pocoo.org/docs/dev/templates/">Jinja2</a> templating language to generate the body and optionally the subject of the mails.
Templates can either be given inline (as string), or read from the filesystem.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">extraHeaders</span></code></dt><dd><p>(dictionary).
A dictionary containing key/value pairs of extra headers to add to sent e-mails.
Both the keys and the values may be a <cite>Interpolate</cite> instance.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">watchedWorkers</span></code></dt><dd><p>This is a list of names of workers, which should be watched. In case a worker get missing, a notification is sent.
The value of <code class="docutils literal notranslate"><span class="pre">watchedWorkers</span></code> can also be set to <em>all</em> (default) or <code class="docutils literal notranslate"><span class="pre">None</span></code>. You also need to specify email address to which the notification is sent in the worker configuration.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">messageFormatterMissingWorker</span></code></dt><dd><p>This is an optional instance of the <code class="docutils literal notranslate"><span class="pre">reporters.messageFormatterMissingWorker</span></code> class that can be used to generate a custom mail message for missing workers.
This class uses the <a class="reference external" href="http://jinja.pocoo.org/docs/dev/templates/">Jinja2</a> templating language to generate the body and optionally the subject of the mails.
Templates can either be given inline (as string), or read from the filesystem.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dumpMailsToLog</span></code></dt><dd><p>If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, all completely formatted mails will be dumped to the log before being sent. This can be useful to debug problems with your mail provider.
Be sure to only turn this on if you really need it, especially if you attach logs to emails. This can dump sensitive information to logs, and make them very large.</p>
</dd>
</dl>
</div>
<div class="section" id="messageformatter-arguments">
<h3><a class="toc-backref" href="#id44">MessageFormatter arguments</a><a class="headerlink" href="#messageformatter-arguments" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to use the <code class="docutils literal notranslate"><span class="pre">messageFormatter</span></code> parameter is to create a new instance of the <code class="docutils literal notranslate"><span class="pre">reporters.MessageFormatter</span></code> class.
The constructor to that class takes the following arguments:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">template_dir</span></code></dt><dd><p>This is the directory that is used to look for the various templates.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">template_filename</span></code></dt><dd><p>This is the name of the file in the <code class="docutils literal notranslate"><span class="pre">template_dir</span></code> directory that will be used to generate the body of the mail.
It defaults to <code class="docutils literal notranslate"><span class="pre">default_mail.txt</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">template</span></code></dt><dd><p>If this parameter is set, this parameter indicates the content of the template used to generate the body of the mail as string.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">template_type</span></code></dt><dd><p>This indicates the type of the generated template.
Use either ‘plain’ (the default) or ‘html’.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">subject_filename</span></code></dt><dd><p>This is the name of the file in the <code class="docutils literal notranslate"><span class="pre">template_dir</span></code> directory that contains the content of the subject of the mail.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">subject</span></code></dt><dd><p>Alternatively, this is the content of the subject of the mail as string.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ctx</span></code></dt><dd><p>This is an extension of the standard context that will be given to the templates.
Use this to add content to the templates that is otherwise not available.</p>
<p>Alternatively, you can subclass MessageFormatter and override the <a class="reference internal" href="#buildAdditionalContext" title="buildAdditionalContext"><code class="xref py py-meth docutils literal notranslate"><span class="pre">buildAdditionalContext()</span></code></a> in order to grab more context from the data API.</p>
<dl class="method">
<dt id="buildAdditionalContext">
<code class="sig-name descname">buildAdditionalContext</code><span class="sig-paren">(</span><em class="sig-param">master</em>, <em class="sig-param">ctx</em><span class="sig-paren">)</span><a class="headerlink" href="#buildAdditionalContext" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>master</strong> – the master object</p></li>
<li><p><strong>ctx</strong> – the context dictionary to enhance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>optionally deferred</p>
</dd>
</dl>
<p>default implementation will add <code class="docutils literal notranslate"><span class="pre">self.ctx</span></code> into the current template context</p>
</dd></dl>

</dd>
<dt><code class="docutils literal notranslate"><span class="pre">wantProperties</span></code></dt><dd><p>This parameter (defaults to True) will extend the content of the given <code class="docutils literal notranslate"><span class="pre">build</span></code> object with the Properties from the build.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">wantSteps</span></code></dt><dd><p>This parameter (defaults to False) will extend the content of the given <code class="docutils literal notranslate"><span class="pre">build</span></code> object with information about the steps of the build.
Use it only when necessary as this increases the overhead in term of CPU and memory on the master.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">wantLogs</span></code></dt><dd><p>This parameter (defaults to False) will extend the content of the steps of the given <code class="docutils literal notranslate"><span class="pre">build</span></code> object with the full Logs of each steps from the build.
This requires <code class="docutils literal notranslate"><span class="pre">wantSteps</span></code> to be True.
Use it only when mandatory as this increases the overhead in term of CPU and memory on the master greatly.</p>
</dd>
</dl>
<p>As a help to those writing Jinja2 templates the following table describes how to get some useful pieces of information from the various data objects:</p>
<dl>
<dt>Name of the builder that generated this event</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">buildername</span> <span class="pre">}}</span></code></p>
</dd>
<dt>Title of the BuildMaster</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">projects</span> <span class="pre">}}</span></code></p>
</dd>
<dt>MailNotifier mode</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">mode</span> <span class="pre">}}</span></code> (a combination of <code class="docutils literal notranslate"><span class="pre">change</span></code>, <code class="docutils literal notranslate"><span class="pre">failing</span></code>, <code class="docutils literal notranslate"><span class="pre">passing</span></code>, <code class="docutils literal notranslate"><span class="pre">problem</span></code>, <code class="docutils literal notranslate"><span class="pre">warnings</span></code>, <code class="docutils literal notranslate"><span class="pre">exception</span></code>, <code class="docutils literal notranslate"><span class="pre">all</span></code>)</p>
</dd>
<dt>URL to build page</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">build_url</span> <span class="pre">}}</span></code></p>
</dd>
<dt>URL to Buildbot main page</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">buildbot_url</span> <span class="pre">}}</span></code></p>
</dd>
<dt>Status of the build as string.</dt><dd><p>This require extending the context of the Formatter via the <code class="docutils literal notranslate"><span class="pre">ctx</span></code> parameter with: <code class="docutils literal notranslate"><span class="pre">ctx=dict(statuses=util.Results)</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">statuses[results]</span> <span class="pre">}}</span></code></p>
</dd>
<dt>Build text</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">build['state_string']</span> <span class="pre">}}</span></code></p>
</dd>
<dt>Mapping of property names to (values, source)</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">build['properties']</span> <span class="pre">}}</span></code></p>
</dd>
<dt>For instance the build reason (from a forced build)</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">build['properties']['reason'][0]</span> <span class="pre">}}</span></code></p>
</dd>
<dt>Worker name</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">workername</span> <span class="pre">}}</span></code></p>
</dd>
<dt>List of responsible users</dt><dd><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">blamelist</span> <span class="pre">|</span> <span class="pre">join(',</span> <span class="pre">')</span> <span class="pre">}}</span></code></p>
</dd>
</dl>
</div>
<div class="section" id="messageformattermissingworkers-arguments">
<h3><a class="toc-backref" href="#id45">MessageFormatterMissingWorkers arguments</a><a class="headerlink" href="#messageformattermissingworkers-arguments" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to use the <code class="docutils literal notranslate"><span class="pre">messageFormatterMissingWorkers</span></code> parameter is to create a new instance of the <code class="docutils literal notranslate"><span class="pre">reporters.MessageFormatterMissingWorkers</span></code> class.</p>
<p>The constructor to that class takes the same arguments as MessageFormatter, minus <code class="docutils literal notranslate"><span class="pre">wantLogs</span></code>, <code class="docutils literal notranslate"><span class="pre">wantProperties</span></code>, <code class="docutils literal notranslate"><span class="pre">wantSteps</span></code>.</p>
<p>The default <code class="docutils literal notranslate"><span class="pre">ctx</span></code> for the missing worker email is made of:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">buildbot_title</span></code></dt><dd><p>The Buildbot title as per <code class="docutils literal notranslate"><span class="pre">c['title']</span></code> from the <code class="docutils literal notranslate"><span class="pre">master.cfg</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">buildbot_url</span></code></dt><dd><p>The Buildbot title as per <code class="docutils literal notranslate"><span class="pre">c['title']</span></code> from the <code class="docutils literal notranslate"><span class="pre">master.cfg</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">worker</span></code></dt><dd><p>The worker object as defined in the REST api plus two attributes:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">notify</span></code></dt><dd><p>List of emails to be notified for this worker.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">last_connection</span></code></dt><dd><p>String describing the approximate the time of last connection for this worker.</p>
</dd>
</dl>
</dd>
</dl>
</div>
</div>
<div class="section" id="pushover-notifications">
<span id="index-1"></span><h2><a class="toc-backref" href="#id46">Pushover Notifications</a><a class="headerlink" href="#pushover-notifications" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.pushover.PushoverNotifier">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.pushover.</code><code class="sig-name descname">PushoverNotifier</code><a class="headerlink" href="#buildbot.reporters.pushover.PushoverNotifier" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Apart of sending mail, Buildbot can send <a class="reference external" href="https://pushover.net/">Pushover</a> notifications. It can be used by administrators to receive an instant message to an iPhone or an Android device if a build fails. The <code class="xref py py-class docutils literal notranslate"><span class="pre">PushoverNotifier</span></code> reporter is used to accomplish this. Its configuration is very similar to the mail notifications, however—due to the notification size constrains—the logs and patches cannot be attached.</p>
<p>To use this reporter, you need to generate and application on the Pushover website <a class="reference external" href="https://pushover.net/apps/">https://pushover.net/apps/</a> and provide your user key and the API token.</p>
<p>The following simple example will send a Pushover notification upon the completion of each build.
The notification contains a description of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Build</span></code>, its results, and URLs where more information can be obtained. The <code class="docutils literal notranslate"><span class="pre">user_key</span></code> and <code class="docutils literal notranslate"><span class="pre">api_token</span></code> values should be replaced with proper ones obtained from the Pushover website for your application.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>
<span class="n">pn</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">PushoverNotifier</span><span class="p">(</span><span class="n">user_key</span><span class="o">=</span><span class="s2">&quot;1234&quot;</span><span class="p">,</span> <span class="n">api_token</span><span class="o">=</span><span class="s1">&#39;abcd&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span>
</pre></div>
</div>
<p>This notifier supports parameters <code class="docutils literal notranslate"><span class="pre">subject</span></code>, <code class="docutils literal notranslate"><span class="pre">mode</span></code>, <code class="docutils literal notranslate"><span class="pre">builders</span></code>, <code class="docutils literal notranslate"><span class="pre">tags</span></code>, <code class="docutils literal notranslate"><span class="pre">schedulers</span></code>, <code class="docutils literal notranslate"><span class="pre">branches</span></code>, <code class="docutils literal notranslate"><span class="pre">buildSetSummary</span></code>, <code class="docutils literal notranslate"><span class="pre">messageFormatter</span></code>, <code class="docutils literal notranslate"><span class="pre">watchedWorkers</span></code>, and <code class="docutils literal notranslate"><span class="pre">messageFormatterMissingWorker</span></code> from the <a href="#id8"><span class="problematic" id="id9">:bb:reporter:`mail notifier &lt;MailNotifier&gt;`</span></a>. See above for their explanation.
However, <code class="docutils literal notranslate"><span class="pre">watchedWorkers</span></code> defaults to <em>None</em>.</p>
<p>The following additional parameters are accepted by this class:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">user_key</span></code></dt><dd><p>The user key from the Pushover website. It is used to identify the notification recipient.
Can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">api_token</span></code></dt><dd><p>API token for a custom application from the Pushover website.
Can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">priorities</span></code></dt><dd><p>Dictionary of Pushover notification priorities. The keys of the dictionary can be <code class="docutils literal notranslate"><span class="pre">change</span></code>, <code class="docutils literal notranslate"><span class="pre">failing</span></code>, <code class="docutils literal notranslate"><span class="pre">passing</span></code>, <code class="docutils literal notranslate"><span class="pre">warnings</span></code>, <code class="docutils literal notranslate"><span class="pre">exception</span></code> and are equivalent to the <code class="docutils literal notranslate"><span class="pre">mode</span></code> strings. The values are integers between -2…2, specifying notification priority. In case a mode is missing from this dictionary, the default value of 0 is used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">otherParams</span></code></dt><dd><p>Other parameters send to Pushover API. Check <a class="reference external" href="https://pushover.net/api/">https://pushover.net/api/</a> for their list.</p>
</dd>
</dl>
</div>
<div class="section" id="pushjet-notifications">
<span id="index-2"></span><h2><a class="toc-backref" href="#id47">Pushjet Notifications</a><a class="headerlink" href="#pushjet-notifications" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.pushover.PushjetNotifier">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.pushover.</code><code class="sig-name descname">PushjetNotifier</code><a class="headerlink" href="#buildbot.reporters.pushover.PushjetNotifier" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><a class="reference external" href="https://pushjet.io/">Pushjet</a> is another instant notification service, similar to <a href="#id10"><span class="problematic" id="id11">:bb:reporter:`Pushover &lt;PushoverNotifier&gt;`</span></a>.
To use this reporter, you need to generate a Pushjet service and provide its secret.</p>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">subject</span></code>, <code class="docutils literal notranslate"><span class="pre">mode</span></code>, <code class="docutils literal notranslate"><span class="pre">builders</span></code>, <code class="docutils literal notranslate"><span class="pre">tags</span></code>, <code class="docutils literal notranslate"><span class="pre">schedulers</span></code>, <code class="docutils literal notranslate"><span class="pre">branches</span></code>, <code class="docutils literal notranslate"><span class="pre">buildSetSummary</span></code>, <code class="docutils literal notranslate"><span class="pre">messageFormatter</span></code>, <code class="docutils literal notranslate"><span class="pre">watchedWorkers</span></code>, and <code class="docutils literal notranslate"><span class="pre">messageFormatterMissingWorker</span></code> are common with <a href="#id12"><span class="problematic" id="id13">:bb:reporter:`mail &lt;MailNotifier&gt;`</span></a> and <a href="#id14"><span class="problematic" id="id15">:bb:reporter:`Pushover &lt;PushoverNotifier&gt;`</span></a> notifier.</p>
<p>The Pushjet specific parameters are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">secret</span></code></dt><dd><p>This is a secret token for your Pushjet service. See <a class="reference external" href="http://docs.pushjet.io/docs/creating-a-new-service">http://docs.pushjet.io/docs/creating-a-new-service</a> to learn how to create a new Pushjet service and get its secret token.
Can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">levels</span></code></dt><dd><p>Dictionary of Pushjet notification levels. The keys of the dictionary can be <code class="docutils literal notranslate"><span class="pre">change</span></code>, <code class="docutils literal notranslate"><span class="pre">failing</span></code>, <code class="docutils literal notranslate"><span class="pre">passing</span></code>, <code class="docutils literal notranslate"><span class="pre">warnings</span></code>, <code class="docutils literal notranslate"><span class="pre">exception</span></code> and are equivalent to the <code class="docutils literal notranslate"><span class="pre">mode</span></code> strings. The values are integers between 0…5, specifying notification priority. In case a mode is missing from this dictionary, the default value set by Pushover is used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">base_url</span></code></dt><dd><p>Base URL for custom Pushjet instances. Defaults to <a class="reference external" href="https://api.pushjet.io">https://api.pushjet.io</a>.</p>
</dd>
</dl>
</div>
<div class="section" id="irc-bot">
<span id="index-3"></span><h2><a class="toc-backref" href="#id48">IRC Bot</a><a class="headerlink" href="#irc-bot" title="Permalink to this headline">¶</a></h2>
<p>The <a href="#id16"><span class="problematic" id="id17">:bb:reporter:`IRC`</span></a> reporter creates an IRC bot which will attach to certain channels and be available for status queries.
It can also be asked to announce builds as they occur, or be told to shut up.</p>
<p>The IRC Bot in buildbot nine, is mostly a rewrite, and not all functionality has been ported yet.
Patches are very welcome for restoring the full functionality.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>
<span class="n">irc</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">IRC</span><span class="p">(</span><span class="s2">&quot;irc.example.org&quot;</span><span class="p">,</span> <span class="s2">&quot;botnickname&quot;</span><span class="p">,</span>
                 <span class="n">useColors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">channels</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;channel&quot;</span><span class="p">:</span> <span class="s2">&quot;#example1&quot;</span><span class="p">},</span>
                           <span class="p">{</span><span class="s2">&quot;channel&quot;</span><span class="p">:</span> <span class="s2">&quot;#example2&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;somesecretpassword&quot;</span><span class="p">}],</span>
                 <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mysecretnickservpassword&quot;</span><span class="p">,</span>
                 <span class="n">authz</span><span class="o">=</span><span class="p">{(</span><span class="s1">&#39;force&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">):</span> <span class="s2">&quot;authorizednick&quot;</span><span class="p">}</span>
                 <span class="n">notify_events</span><span class="o">=</span><span class="p">[</span>
                   <span class="s1">&#39;exception&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;problem&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;recovery&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;worker&#39;</span>
                 <span class="p">])</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irc</span><span class="p">)</span>
</pre></div>
</div>
<p>The following parameters are accepted by this class:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">host</span></code></dt><dd><p>(mandatory)
The IRC server address to connect to.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nick</span></code></dt><dd><p>(mandatory)
The name this bot will use on the IRC server.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">channels</span></code></dt><dd><p>(mandatory)
This is a list of channels to join on the IRC server.
Each channel can be a string (e.g. <code class="docutils literal notranslate"><span class="pre">#buildbot</span></code>), or a dictionary <code class="docutils literal notranslate"><span class="pre">{'channel':</span> <span class="pre">'#buildbot',</span> <span class="pre">'password':</span> <span class="pre">'secret'}</span></code> if each channel requires a different password.
A global password can be set with the <code class="docutils literal notranslate"><span class="pre">password</span></code> parameter.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pm_to_nicks</span></code></dt><dd><p>(optional)
This is a list of person to contact on the IRC server.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">authz</span></code></dt><dd><p>(optional)
Authentication list for commands. It must be a dictionary with command names or tuples of command names as keys. There are two special command names: <code class="docutils literal notranslate"><span class="pre">''</span></code> (empty string) meaning any harmless command and <code class="docutils literal notranslate"><span class="pre">'!'</span></code> for dangerous commands (currently <code class="docutils literal notranslate"><span class="pre">force</span></code>, <code class="docutils literal notranslate"><span class="pre">stop</span></code>, and <code class="docutils literal notranslate"><span class="pre">shutdown</span></code>). The dictionary values are either <code class="docutils literal notranslate"><span class="pre">True</span></code> of <code class="docutils literal notranslate"><span class="pre">False</span></code> (which allows or deny commands for everybody) or a list of nicknames authorized to issue specified commands. By default, harmless commands are allowed for everybody and the dangerous ones are prohibited.</p>
<p>A sample <code class="docutils literal notranslate"><span class="pre">authz</span></code> parameter may look as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authz</span><span class="o">=</span><span class="p">(</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
  <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;alice&#39;</span><span class="p">,</span> <span class="s1">&#39;bob&#39;</span><span class="p">],</span>
  <span class="p">(</span><span class="s1">&#39;force&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;alice&#39;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Anybody will be able to run the <code class="docutils literal notranslate"><span class="pre">version</span></code> command, <em>alice</em> and <em>bob</em> will be allowed to run any safe command and <em>alice</em> will also have the right to force and stop builds.</p>
<p>This parameter replaces older <code class="docutils literal notranslate"><span class="pre">allowForce</span></code> and <code class="docutils literal notranslate"><span class="pre">allowShutdown</span></code>, which are deprecated as they were considered a security risk.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The authorization is purely nick-based, so it only makes sense if the specified nicks are registered to the IRC server.</p>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">port</span></code></dt><dd><p>(optional, default to 6667)
The port to connect to on the IRC server.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tags</span></code></dt><dd><p>(optional)
When set, this bot will only communicate about builders containing those tags.
(tags functionality is not yet ported)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">password</span></code></dt><dd><p>(optional)
The global password used to register the bot to the IRC server.
If provided, it will be sent to Nickserv to claim the nickname: some IRC servers will not allow clients to send private messages until they have logged in with a password.
Can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">notify_events</span></code></dt><dd><p>(optional)
A list or set of events to be notified on the IRC channels.
At the moment, irc bot can listen to build ‘start’ and ‘finish’ events. It can also notify about missing workers and their return.
This parameter can be changed during run-time by sending the <code class="docutils literal notranslate"><span class="pre">notify</span></code> command to the bot. Note however, that at the buildbot restart or reconfig the notifications listed here will be turned on for the specified channel and nicks. On the other hand, removing events from this parameters will not automatically stop notifications for them (you need to turn them off for every channel with the <code class="docutils literal notranslate"><span class="pre">notify</span></code> command).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">noticeOnChannel</span></code></dt><dd><p>(optional, disabled by default)
Whether to send notices rather than messages when communicating with a channel.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">showBlameList</span></code></dt><dd><p>(optional, disabled by default)
Whether or not to display the blame list for failed builds.
(blame list functionality is not ported yet)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">useRevisions</span></code></dt><dd><p>(optional, disabled by default)
Whether or not to display the revision leading to the build the messages are about.
(useRevisions functionality is not ported yet)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">useSSL</span></code></dt><dd><p>(optional, disabled by default)
Whether or not to use SSL when connecting to the IRC server.
Note that this option requires <a class="reference external" href="http://pyopenssl.sourceforge.net/">PyOpenSSL</a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">lostDelay</span></code></dt><dd><p>(optional)
Delay to wait before reconnecting to the server when the connection has been lost.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">failedDelay</span></code></dt><dd><p>(optional)
Delay to wait before reconnecting to the IRC server when the connection failed.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">useColors</span></code></dt><dd><p>(optional, enabled by default)
The bot can add color to some of its messages.
You might turn it off by setting this parameter to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
<p>The following parameters are deprecated. You must not use them if you use the new <code class="docutils literal notranslate"><span class="pre">authz</span></code> parameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Security Note</p>
<p>Please note that any user having access to your irc channel or can PM the bot will be able to create or stop builds <a href="#id18"><span class="problematic" id="id19">:bug:`3377`</span></a>.
Use <code class="docutils literal notranslate"><span class="pre">authz</span></code> to give explicit list of nicks who are allowed to do this.</p>
</div>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">allowForce</span></code></dt><dd><p>(deprecated, disabled by default)
This allow all users to force and stop builds via this bot.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">allowShutdown</span></code></dt><dd><p>(deprecated, disabled by default)
This allow all users to shutdown the master.</p>
</dd>
</dl>
<p>To use the service, you address messages at the Buildbot, either normally (<code class="docutils literal notranslate"><span class="pre">botnickname:</span> <span class="pre">status</span></code>) or with private messages (<code class="docutils literal notranslate"><span class="pre">/msg</span> <span class="pre">botnickname</span> <span class="pre">status</span></code>).
The Buildbot will respond in kind.</p>
<p>If you issue a command that is currently not available, the Buildbot will respond with an error message.
If the <code class="docutils literal notranslate"><span class="pre">noticeOnChannel=True</span></code> option was used, error messages will be sent as channel notices instead of messaging.</p>
<p>Some of the commands currently available:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">builders</span></code></dt><dd><p>Emit a list of all configured builders</p>
</dd>
<dt><code class="samp docutils literal notranslate"><span class="pre">status</span> <em><span class="pre">BUILDER</span></em></code></dt><dd><p>Announce the status of a specific Builder: what it is doing right now.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">status</span> <span class="pre">all</span></code></dt><dd><p>Announce the status of all Builders</p>
</dd>
<dt><code class="samp docutils literal notranslate"><span class="pre">watch</span> <em><span class="pre">BUILDER</span></em></code></dt><dd><p>If the given <code class="xref py py-class docutils literal notranslate"><span class="pre">Builder</span></code> is currently running, wait until the <code class="xref py py-class docutils literal notranslate"><span class="pre">Build</span></code> is finished and then announce the results.</p>
</dd>
<dt><code class="samp docutils literal notranslate"><span class="pre">last</span> <em><span class="pre">BUILDER</span></em></code></dt><dd><p>Return the results of the last build to run on the given <code class="xref py py-class docutils literal notranslate"><span class="pre">Builder</span></code>.</p>
</dd>
<dt><code class="samp docutils literal notranslate"><span class="pre">notify</span> <span class="pre">on|off|list</span> <em><span class="pre">EVENT</span></em></code></dt><dd><p>Report events relating to builds.
If the command is issued as a private message, then the report will be sent back as a private message to the user who issued the command.
Otherwise, the report will be sent to the channel.
Available events to be notified are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">started</span></code></dt><dd><p>A build has started.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finished</span></code></dt><dd><p>A build has finished.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">success</span></code></dt><dd><p>A build finished successfully.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">failure</span></code></dt><dd><p>A build failed.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">exception</span></code></dt><dd><p>A build generated and exception.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">cancelled</span></code></dt><dd><p>A build was cancelled.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">problem</span></code></dt><dd><p>The previous build result was success or warnings, but this one ended with failure or exception.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">recovery</span></code></dt><dd><p>This is the opposite of <code class="docutils literal notranslate"><span class="pre">problem</span></code>: the previous build result was failure or exception and this one ended with success or warnings.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">worse</span></code></dt><dd><p>A build state was worse than the previous one (so e.g. it ended with warnings and the previous one was successful).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">better</span></code></dt><dd><p>A build state was better than the previous one.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">worker</span></code></dt><dd><p>A worker is missing. A notification is also send when the previously reported missing worker connects again.</p>
</dd>
</dl>
<p>By default this command can be executed by anybody. However, consider limiting it with <code class="docutils literal notranslate"><span class="pre">authz</span></code>, as enabling notifications in huge number of channels or private chats can cause some problems with your buildbot efficiency.</p>
</dd>
<dt><code class="samp docutils literal notranslate"><span class="pre">help</span> <em><span class="pre">COMMAND</span></em></code></dt><dd><p>Describe a command.
Use <strong class="command">help commands</strong> to get a list of known commands.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">source</span></code></dt><dd><p>Announce the URL of the Buildbot’s home page.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">version</span></code></dt><dd><p>Announce the version of this Buildbot.</p>
</dd>
</dl>
<p>Additionally, the config file may specify default notification options as shown in the example earlier.</p>
<p>If explicitly allowed in the <code class="docutils literal notranslate"><span class="pre">authz</span></code> config, some additional commands will be available:</p>
<dl class="simple">
<dt><code class="samp docutils literal notranslate"><span class="pre">join</span> <em><span class="pre">CHANNEL</span></em></code></dt><dd><p>Join the given IRC channel</p>
</dd>
<dt><code class="samp docutils literal notranslate"><span class="pre">leave</span> <em><span class="pre">CHANNEL</span></em></code></dt><dd><p>Leave the given IRC channel</p>
</dd>
</dl>
<dl id="index-4">
<dt><code class="samp docutils literal notranslate"><span class="pre">force</span> <span class="pre">build</span> <span class="pre">[--codebase=</span><em><span class="pre">CODEBASE</span></em><span class="pre">]</span> <span class="pre">[--branch=</span><em><span class="pre">BRANCH</span></em><span class="pre">]</span> <span class="pre">[--revision=</span><em><span class="pre">REVISION</span></em><span class="pre">]</span> <span class="pre">[--props=PROP1=VAL1,PROP2=VAL2...]</span> <em><span class="pre">BUILDER</span></em> <em><span class="pre">REASON</span></em></code></dt><dd><p>Tell the given <code class="xref py py-class docutils literal notranslate"><span class="pre">Builder</span></code> to start a build of the latest code.
The user requesting the build and <em>REASON</em> are recorded in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Build</span></code> status.
The Buildbot will announce the build’s status when it finishes.The user can specify a branch and/or revision with the optional parameters <code class="samp docutils literal notranslate"><span class="pre">--branch=</span><em><span class="pre">BRANCH</span></em></code> and <code class="samp docutils literal notranslate"><span class="pre">--revision=</span><em><span class="pre">REVISION</span></em></code>.
The user can also give a list of properties with <code class="samp docutils literal notranslate"><span class="pre">--props=</span><em><span class="pre">PROP1=VAL1,PROP2=VAL2..</span></em></code>.</p>
</dd>
<dt><code class="samp docutils literal notranslate"><span class="pre">stop</span> <span class="pre">build</span> <em><span class="pre">BUILDER</span></em> <em><span class="pre">REASON</span></em></code></dt><dd><p>Terminate any running build in the given <code class="xref py py-class docutils literal notranslate"><span class="pre">Builder</span></code>.
<em>REASON</em> will be added to the build status to explain why it was stopped.
You might use this if you committed a bug, corrected it right away, and don’t want to wait for the first build (which is destined to fail) to complete before starting the second (hopefully fixed) build.</p>
</dd>
<dt><code class="samp docutils literal notranslate"><span class="pre">shutdown</span> <em><span class="pre">ARG</span></em></code></dt><dd><p>Control the shutdown process of the Buildbot master.
Available arguments are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">check</span></code></dt><dd><p>Check if the Buildbot master is running or shutting down</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">start</span></code></dt><dd><p>Start clean shutdown</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">stop</span></code></dt><dd><p>Stop clean shutdown</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">now</span></code></dt><dd><p>Shutdown immediately without waiting for the builders to finish</p>
</dd>
</dl>
</dd>
</dl>
<p>If the <cite>tags</cite> is set (see the tags option in <a class="reference internal" href="builders.html#builder-configuration"><span class="std std-ref">Builder Configuration</span></a>) changes related to only builders belonging to those tags of builders will be sent to the channel.</p>
<p>If the <cite>useRevisions</cite> option is set to <cite>True</cite>, the IRC bot will send status messages that replace the build number with a list of revisions that are contained in that build.
So instead of seeing <cite>build #253 of …</cite>, you would see something like <cite>build containing revisions [a87b2c4]</cite>.
Revisions that are stored as hashes are shortened to 7 characters in length, as multiple revisions can be contained in one build and may exceed the IRC message length limit.</p>
<p>Two additional arguments can be set to control how fast the IRC bot tries to reconnect when it encounters connection issues.
<code class="docutils literal notranslate"><span class="pre">lostDelay</span></code> is the number of seconds the bot will wait to reconnect when the connection is lost, where as <code class="docutils literal notranslate"><span class="pre">failedDelay</span></code> is the number of seconds until the bot tries to reconnect when the connection failed.
<code class="docutils literal notranslate"><span class="pre">lostDelay</span></code> defaults to a random number between 1 and 5, while <code class="docutils literal notranslate"><span class="pre">failedDelay</span></code> defaults to a random one between 45 and 60.
Setting random defaults like this means multiple IRC bots are less likely to deny each other by flooding the server.</p>
</div>
<div class="section" id="telegram-bot">
<h2><a class="toc-backref" href="#id49">Telegram Bot</a><a class="headerlink" href="#telegram-bot" title="Permalink to this headline">¶</a></h2>
<p>Buildbot offers a bot, similar to the <a href="#id20"><span class="problematic" id="id21">:bb:reporter:`IRC`</span></a> for Telegram mobile and desktop messaging app. The bot can notify users and groups about build events, respond to status queries, or force and stop builds on request (if allowed to).</p>
<p>In order to use this reporter, you must first speak to <a class="reference external" href="https://telegram.me/botfather">BotFather</a> and create a <a class="reference external" href="https://core.telegram.org/bots#creating-a-new-bot">new telegram bot</a>. A quick step-by-step procedure is as follows:</p>
<ol class="arabic">
<li><p>Start a chat with <a class="reference external" href="https://telegram.me/botfather">BotFather</a>.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">/newbot</span></code>.</p></li>
<li><p>Enter a display name for your bot. It can be any string.</p></li>
<li><p>Enter a unique username for your bot. Usernames are 5-32 characters long and are case insensitive, but may only include Latin characters, numbers, and underscores. Your bot’s username must end in <cite>bot</cite>, e.g. <cite>MyBuildBot</cite> or <cite>MyBuildbotBot</cite>.</p></li>
<li><p>You will be presented with a token for your bot. Save it, as you will need it for <a href="#id22"><span class="problematic" id="id23">:bb:reporter:`TelegramBot`</span></a> configuration.</p></li>
<li><p>Optionally, you may type <code class="docutils literal notranslate"><span class="pre">/setcommands</span></code>, select the username of your new bot and paste the following text:</p>
<blockquote>
<div></div></blockquote>
<p>If you do this, Telegram will provide hints about your bot commands.</p>
</li>
<li><p>If you want, you can set a custom picture and description for your bot.</p></li>
</ol>
<p>After setting up the bot in Telegram, you should configure it in Buildbot.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>
<span class="n">telegram</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">TelegramBot</span><span class="p">(</span>
        <span class="n">bot_token</span><span class="o">=</span><span class="s1">&#39;bot_token_given_by_botfather&#39;</span><span class="p">,</span>
        <span class="n">bot_username</span><span class="s1">&#39;username_set_in_botfather_bot&#39;</span><span class="p">,</span>
        <span class="n">chat_ids</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1234567</span><span class="p">],</span>
        <span class="n">authz</span><span class="o">=</span><span class="p">{(</span><span class="s1">&#39;force&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">):</span> <span class="s2">&quot;authorizednick&quot;</span><span class="p">}</span>
        <span class="n">notify_events</span><span class="o">=</span><span class="p">[</span>
            <span class="s1">&#39;exception&#39;</span><span class="p">,</span>
            <span class="s1">&#39;problem&#39;</span><span class="p">,</span>
            <span class="s1">&#39;recovery&#39;</span><span class="p">,</span>
            <span class="s1">&#39;worker&#39;</span>
        <span class="p">],</span>
        <span class="n">usePolling</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">telegram</span><span class="p">)</span>
</pre></div>
</div>
<p>The following parameters are accepted by this class:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">bot_token</span></code></dt><dd><p>(mandatory)
Bot token given by BotFather.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">bot_username</span></code></dt><dd><p>(optional)
This should be set to the the bot unique username defined in BotFather. If this parameter is missing, it will be retrieved from the Telegram server. However, in case of the connection problems, configuration of the Buildbot will be interrupted. For this reason it is advised to set this parameter to the correct value.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">chat_ids</span></code></dt><dd><p>(optional)
List of chats IDs to send notifications specified in the <code class="docutils literal notranslate"><span class="pre">notify_events</span></code> parameter. For channels it should have form <code class="docutils literal notranslate"><span class="pre">&#64;channelusername</span></code> and for private chats and groups it should be a numeric ID. To get it, talk to your bot or add it to a Telegram group and issue <code class="docutils literal notranslate"><span class="pre">/getid</span></code> command.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to receive notification from the bot, you need to talk to it first (and hit the <code class="docutils literal notranslate"><span class="pre">/start</span></code> button) or add it to the group chat.</p>
</div>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">authz</span></code></dt><dd><p>(optional)
Authentication list for commands. It must be a dictionary with command names (without slashes) or tuples of command names as keys. There are two special command names: <code class="docutils literal notranslate"><span class="pre">''</span></code> (empty string) meaning any harmless command and <code class="docutils literal notranslate"><span class="pre">'!'</span></code> for dangerous commands (currently <code class="docutils literal notranslate"><span class="pre">/force</span></code>, <code class="docutils literal notranslate"><span class="pre">/stop</span></code>, and <code class="docutils literal notranslate"><span class="pre">/shutdown</span></code>). The dictionary values are either <code class="docutils literal notranslate"><span class="pre">True</span></code> of <code class="docutils literal notranslate"><span class="pre">False</span></code> (which allows or deny commands for everybody) or a list of numeric IDs authorized to issue specified commands. By default, harmless commands are allowed for everybody and the dangerous ones are prohibited.</p>
<p>A sample <code class="docutils literal notranslate"><span class="pre">authz</span></code> parameter may look as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authz</span><span class="o">=</span><span class="p">(</span>
  <span class="s1">&#39;getid&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
  <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">123456</span><span class="p">,</span> <span class="mi">789012</span><span class="p">],</span>
  <span class="p">(</span><span class="s1">&#39;force&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">):</span> <span class="p">[</span><span class="mi">123456</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Anybody will be able to run the <code class="docutils literal notranslate"><span class="pre">getid</span></code> command, users with IDs 123456 and 789012 will be allowed to run any safe command and the user with ID 123456 will also have the right to force and stop builds.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tags</span></code></dt><dd><p>(optional)
When set, this bot will only communicate about builders containing those tags.
(tags functionality is not yet implemented)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">notify_events</span></code></dt><dd><p>(optional)
A list or set of events to be notified on the Telegram chats.
Telegram bot can listen to build ‘start’ and ‘finish’ events. It can also notify about missing workers and their return.
This parameter can be changed during run-time by sending the <code class="docutils literal notranslate"><span class="pre">/notify</span></code> command to the bot.  Note however, that at the buildbot restart or reconfig the notifications listed here will be turned on for the specified chats. On the other hand, removing events from this parameters will not automatically stop notifications for them (you need to turn them off for every channel with the <code class="docutils literal notranslate"><span class="pre">/notify</span></code> command).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">showBlameList</span></code></dt><dd><p>(optional, disabled by default)
Whether or not to display the blame list for failed builds.
(blame list functionality is not yet implemented)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">useRevisions</span></code></dt><dd><p>(optional, disabled by default)
Whether or not to display the revision leading to the build the messages are about.
(useRevisions functionality is not yet implemented)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">useWebhook</span></code></dt><dd><p>(optional, disabled by default)
By default this bot receives messages from Telegram through polling. You can configure it to use a  web-hook, which may be more efficient. However, this requires the web frontend of the Buildbot to be configured and accessible through HTTPS (not HTTP) on a public IP and port number 443, 80, 88, or 8443. Furthermore, the Buildbot configuration option <a href="#id24"><span class="problematic" id="id25">:bb:cfg:`buildbotURL`</span></a> must be correctly set. If you are using HTTP authentication, please ensure that the location <em>buildbotURL</em><code class="docutils literal notranslate"><span class="pre">/telegram</span></code><em>bot_token</em> (e.g. <code class="docutils literal notranslate"><span class="pre">https://buildbot.example.com/telegram123456:secret</span></code>) is accessible by everybody.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">certificate</span></code></dt><dd><p>(optional)
A content of your server SSL certificate. This is necessary if the access to the Buildbot web interface is through HTTPS protocol with self-signed certificate and <code class="docutils literal notranslate"><span class="pre">userWebhook</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pollTimeout</span></code></dt><dd><p>(optional)
The time the bot should wait for Telegram to respond to polling using <a class="reference external" href="https://en.wikipedia.org/wiki/Push_technology#Long_polling">long polling</a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">retryDelay</span></code></dt><dd><p>(optional)
The delay the bot should wait before attempting to retry communication in case of no connection.</p>
</dd>
</dl>
<p>To use the service, you sent Telegram commands (messages starting with a slash) to the bot. In most cases you do not need to add any parameters; the bot will ask you about the details.</p>
<p>Some of the commands currently available:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">/getid</span></code></dt><dd><p>Get ID of the user and group. This is useful to find the numeric IDs, which should be put in <code class="docutils literal notranslate"><span class="pre">authz</span></code> and <code class="docutils literal notranslate"><span class="pre">chat_ids</span></code> configuration parameters.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/list</span></code></dt><dd><p>Emit a list of all configured builders, workers or recent changes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/status</span></code></dt><dd><p>Announce the status of all builders.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/watch</span></code></dt><dd><p>You will be presented with a list of builders that are currently running. You can select any of them to be notified when the build finishes..</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/last</span></code></dt><dd><p>Return the results of the last builds on every builder.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/notify</span></code></dt><dd><p>Report events relating to builds.
If the command is issued as a private message, then the report will be sent back as a private message to the user who issued the command.
Otherwise, the report will be sent to the group chat.
Available events to be notified are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">started</span></code></dt><dd><p>A build has started.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finished</span></code></dt><dd><p>A build has finished.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">success</span></code></dt><dd><p>A build finished successfully.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">failure</span></code></dt><dd><p>A build failed.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">exception</span></code></dt><dd><p>A build generated and exception.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">cancelled</span></code></dt><dd><p>A build was cancelled.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">problem</span></code></dt><dd><p>The previous build result was success or warnings, but this one ended with failure or exception.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">recovery</span></code></dt><dd><p>This is the opposite of <code class="docutils literal notranslate"><span class="pre">problem</span></code>: the previous build result was failure or exception and this one ended with success or warnings.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">worse</span></code></dt><dd><p>A build state was worse than the previous one (so e.g. it ended with warnings and the previous one was successful).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">better</span></code></dt><dd><p>A build state was better than the previous one.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">worker</span></code></dt><dd><p>A worker is missing. A notification is also send when the previously reported missing worker connects again.</p>
</dd>
</dl>
<p>By default this command can be executed by anybody. However, consider limiting it with <code class="docutils literal notranslate"><span class="pre">authz</span></code>, as enabling notifications in huge number of chats (of any kind) can cause some problems with your buildbot efficiency.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/help</span></code></dt><dd><p>Show short help for the commands.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/commands</span></code></dt><dd><p>List all available commands.
If you explicitly type <code class="docutils literal notranslate"><span class="pre">/commands</span> <span class="pre">botfather</span></code>, the bot will respond with a list of commands with short descriptions, to be provided to BotFather.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/source</span></code></dt><dd><p>Announce the URL of the Buildbot’s home page.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/version</span></code></dt><dd><p>Announce the version of this Buildbot.</p>
</dd>
</dl>
<p>If explicitly allowed in the <code class="docutils literal notranslate"><span class="pre">authz</span></code> config, some additional commands will be available:</p>
<dl class="simple" id="index-5">
<dt><code class="docutils literal notranslate"><span class="pre">/force</span></code></dt><dd><p>Force a build. The bot will read configuration from every configured <a href="#id26"><span class="problematic" id="id27">:bb:sched:`ForceScheduler`</span></a> and present you with the build parameters you can change. If you set all the required parameters, you will be given an option to start the build.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/stop</span></code></dt><dd><p>Stop a build. If there are any active builds, you will be presented with options to stop them.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/shutdown</span></code></dt><dd><p>Control the shutdown process of the Buildbot master.
You will be presented with options to start a graceful shutdown, stop it or to shutdown immediately.</p>
</dd>
</dl>
<p>If you are in the middle of the conversation with the bot (e.g. it has just asked you a question), you can always stop the current command with a command <code class="docutils literal notranslate"><span class="pre">/nay</span></code>.</p>
<p>If the <cite>tags</cite> is set (see the tags option in <a class="reference internal" href="builders.html#builder-configuration"><span class="std std-ref">Builder Configuration</span></a>) changes related to only builders belonging to those tags of builders will be sent to the channel.</p>
<p>If the <cite>useRevisions</cite> option is set to <cite>True</cite>, the IRC bot will send status messages that replace the build number with a list of revisions that are contained in that build.
So instead of seeing <cite>build #253 of …</cite>, you would see something like <cite>build containing revisions a87b2c4</cite>.
Revisions that are stored as hashes are shortened to 7 characters in length, as multiple revisions can be contained in one build and may result in too long messages.</p>
</div>
<div class="section" id="gerritstatuspush">
<h2><a class="toc-backref" href="#id50">GerritStatusPush</a><a class="headerlink" href="#gerritstatuspush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.status.status_gerrit.GerritStatusPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.status.status_gerrit.</code><code class="sig-name descname">GerritStatusPush</code><a class="headerlink" href="#buildbot.status.status_gerrit.GerritStatusPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><a class="reference internal" href="#GerritStatusPush" title="GerritStatusPush"><code class="xref py py-class docutils literal notranslate"><span class="pre">GerritStatusPush</span></code></a> sends review of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Change</span></code> back to the Gerrit server, optionally also sending a message when a build is started.
GerritStatusPush can send a separate review for each build that completes, or a single review summarizing the results for all of the builds.</p>
<dl class="class">
<dt id="GerritStatusPush">
<em class="property">class </em><code class="sig-name descname">GerritStatusPush</code><span class="sig-paren">(</span><em class="sig-param">server</em>, <em class="sig-param">username</em>, <em class="sig-param">reviewCB</em>, <em class="sig-param">startCB</em>, <em class="sig-param">port</em>, <em class="sig-param">reviewArg</em>, <em class="sig-param">startArg</em>, <em class="sig-param">summaryCB</em>, <em class="sig-param">summaryArg</em>, <em class="sig-param">identity_file</em>, <em class="sig-param">builders</em>, <em class="sig-param">notify...</em><span class="sig-paren">)</span><a class="headerlink" href="#GerritStatusPush" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>server</strong> (<em>string</em>) – Gerrit SSH server’s address to use for push event notifications.</p></li>
<li><p><strong>username</strong> (<em>string</em>) – Gerrit SSH server’s username.</p></li>
<li><p><strong>identity_file</strong> – (optional) Gerrit SSH identity file.</p></li>
<li><p><strong>port</strong> (<em>int</em>) – (optional) Gerrit SSH server’s port (default: 29418)</p></li>
<li><p><strong>reviewCB</strong> – (optional) Called each time a build finishes. Build properties are available. Can be a deferred.</p></li>
<li><p><strong>reviewArg</strong> – <p>(optional) argument passed to the review callback.</p>
<p>If <code class="xref py py-func docutils literal notranslate"><span class="pre">reviewCB()</span></code> callback is specified, it must return a message and optionally labels. If no message is specified, nothing will be sent to Gerrit.
It should return a dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
 <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">label</span><span class="o">-</span><span class="n">name</span><span class="p">:</span> <span class="n">label</span><span class="o">-</span><span class="n">score</span><span class="p">,</span>
            <span class="o">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For example:</p>
<p>Which require an extra import in the config:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">util</span>
</pre></div>
</div>
</p></li>
<li><p><strong>startCB</strong> – (optional) Called each time a build is started. Build properties are available. Can be a deferred.</p></li>
<li><p><strong>startArg</strong> – <p>(optional) argument passed to the start callback.</p>
<p>If <code class="xref py py-func docutils literal notranslate"><span class="pre">startCB()</span></code> is specified, it must return a message and optionally labels. If no message is specified, nothing will be sent to Gerrit.
It should return a dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
 <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">label</span><span class="o">-</span><span class="n">name</span><span class="p">:</span> <span class="n">label</span><span class="o">-</span><span class="n">score</span><span class="p">,</span>
            <span class="o">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For example:</p>
</p></li>
<li><p><strong>summaryCB</strong> – (optional) Called each time a buildset finishes. Each build in the buildset has properties available. Can be a deferred.</p></li>
<li><p><strong>summaryArg</strong> – <p>(optional) argument passed to the summary callback.</p>
<p>If <code class="xref py py-func docutils literal notranslate"><span class="pre">summaryCB()</span></code> callback is specified, it must return a message and optionally labels. If no message is specified, nothing will be sent to Gerrit.
The message and labels should be a summary of all the builds within the buildset.
It should return a dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
 <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">label</span><span class="o">-</span><span class="n">name</span><span class="p">:</span> <span class="n">label</span><span class="o">-</span><span class="n">score</span><span class="p">,</span>
            <span class="o">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For example:</p>
</p></li>
<li><p><strong>builders</strong> – (optional) list of builders to send results for.
This method allows to filter results for a specific set of builder.
By default, or if builders is None, then no filtering is performed.</p></li>
<li><p><strong>notify</strong> – (optional) control who gets notified by Gerrit once the status is posted.
The possible values for <cite>notify</cite> can be found in your version of the
Gerrit documentation for the <cite>gerrit review</cite> command.</p></li>
<li><p><strong>wantSteps</strong> – (optional, defaults to False) Extends the given <code class="docutils literal notranslate"><span class="pre">build</span></code> object with information about steps of the build.
Use it only when necessary as this increases the overhead in term of CPU and memory on the master.</p></li>
<li><p><strong>wantLogs</strong> – (optional, default to False) Extends the steps of the given <code class="docutils literal notranslate"><span class="pre">build</span></code> object with the full logs of the build.
This requires <code class="docutils literal notranslate"><span class="pre">wantSteps</span></code> to be True.
Use it only when mandatory as this increases the overhead in term of CPU and memory on the master greatly.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, a single summary review is sent; that is, a default <code class="xref py py-func docutils literal notranslate"><span class="pre">summaryCB()</span></code> is provided, but no <code class="xref py py-func docutils literal notranslate"><span class="pre">reviewCB()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">startCB()</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="xref py py-func docutils literal notranslate"><span class="pre">reviewCB()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">summaryCB()</span></code> do not return any labels, only a message will be pushed to the Gerrit server.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a href="#id28"><span class="problematic" id="id29">:src:`master/docs/examples/git_gerrit.cfg`</span></a> and <a href="#id30"><span class="problematic" id="id31">:src:`master/docs/examples/repo_gerrit.cfg`</span></a> in the Buildbot distribution provide a full example setup of Git+Gerrit or Repo+Gerrit of <a href="#id32"><span class="problematic" id="id33">:bb:reporter:`GerritStatusPush`</span></a>.</p>
</div>
</div>
<div class="section" id="httpstatuspush">
<h2><a class="toc-backref" href="#id51">HttpStatusPush</a><a class="headerlink" href="#httpstatuspush" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">HttpStatusPush</span><span class="p">(</span><span class="n">serverUrl</span><span class="o">=</span><span class="s2">&quot;http://example.com/submit&quot;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#HttpStatusPush" title="HttpStatusPush"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpStatusPush</span></code></a> builds on <code class="xref py py-class docutils literal notranslate"><span class="pre">StatusPush</span></code> and sends HTTP requests to <code class="docutils literal notranslate"><span class="pre">serverUrl</span></code>, with all the items json-encoded.
It is useful to create a status front end outside of Buildbot for better scalability.</p>
<p>It requires either <a class="reference external" href="https://pypi.python.org/pypi/txrequests">txrequests</a> or <a class="reference external" href="https://pypi.python.org/pypi/treq">treq</a> to be installed to allow interaction with http server.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The json data object sent is completely different from the one that was generated by 0.8.x buildbot.
It is indeed generated using data api.</p>
</div>
<dl class="class">
<dt id="HttpStatusPush">
<em class="property">class </em><code class="sig-name descname">HttpStatusPush</code><span class="sig-paren">(</span><em class="sig-param">serverUrl</em>, <em class="sig-param">user=None</em>, <em class="sig-param">password=None</em>, <em class="sig-param">auth=None</em>, <em class="sig-param">format_fn=None</em>, <em class="sig-param">builders=None</em>, <em class="sig-param">wantProperties=False</em>, <em class="sig-param">wantSteps=False</em>, <em class="sig-param">wantPreviousBuild=False</em>, <em class="sig-param">wantLogs=False</em>, <em class="sig-param">debug=None</em>, <em class="sig-param">verify=None</em><span class="sig-paren">)</span><a class="headerlink" href="#HttpStatusPush" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>serverUrl</strong> (<em>string</em>) – the url where to do the http post</p></li>
<li><p><strong>user</strong> (<em>string</em>) – the BasicAuth user to post as</p></li>
<li><p><strong>password</strong> (<em>string</em>) – the BasicAuth user’s password (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>).</p></li>
<li><p><strong>auth</strong> – the authentication method to use.
Refer to the documentation of the requests library for more information.</p></li>
<li><p><strong>format_fn</strong> (<em>function</em>) – a function that takes the build as parameter and returns a dictionary to be pushed to the server (as json).</p></li>
<li><p><strong>builders</strong> (<em>list</em>) – only send update for specified builders</p></li>
<li><p><strong>wantProperties</strong> (<em>boolean</em>) – include ‘properties’ in the build dictionary</p></li>
<li><p><strong>wantSteps</strong> (<em>boolean</em>) – include ‘steps’ in the build dictionary</p></li>
<li><p><strong>wantLogs</strong> (<em>boolean</em>) – include ‘logs’ in the steps dictionaries.
This needs wantSteps=True.
This dumps the <em>full</em> content of logs and may consume lots of memory and CPU depending on the log size.</p></li>
<li><p><strong>wantPreviousBuild</strong> (<em>boolean</em>) – include ‘prev_build’ in the build dictionary</p></li>
<li><p><strong>debug</strong> (<em>boolean</em>) – logs every requests and their response</p></li>
<li><p><strong>verify</strong> (<em>boolean</em>) – disable ssl verification for the case you use temporary self signed certificates</p></li>
<li><p><strong>skipEncoding</strong> (<em>boolean</em>) – disables encoding of json data to bytes before pushing to server</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="section" id="json-object-spec">
<h3><a class="toc-backref" href="#id52">Json object spec</a><a class="headerlink" href="#json-object-spec" title="Permalink to this headline">¶</a></h3>
<p>The default json object sent is a build object augmented with some more data as follow.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://yourbot/path/to/build&quot;</span><span class="p">,</span>
    <span class="nt">&quot;&lt;build data api values&gt;&quot;</span><span class="p">:</span> <span class="s2">&quot;[...]&quot;</span><span class="p">,</span>
    <span class="nt">&quot;buildset&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;buildset data api values&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;builder&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;builder data api values&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;buildrequest&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;buildrequest data api values&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you want another format, don’t hesitate to use the <code class="docutils literal notranslate"><span class="pre">format_fn</span></code> parameter to customize the payload.
The <code class="docutils literal notranslate"><span class="pre">build</span></code> parameter given to that function is of type <a href="#id34"><span class="problematic" id="id35">:bb:rtype:`build`</span></a>, optionally enhanced with properties, steps, and logs information.</p>
</div>
</div>
<div class="section" id="githubstatuspush">
<h2><a class="toc-backref" href="#id53">GitHubStatusPush</a><a class="headerlink" href="#githubstatuspush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.github.GitHubStatusPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.github.</code><code class="sig-name descname">GitHubStatusPush</code><a class="headerlink" href="#buildbot.reporters.github.GitHubStatusPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span><span class="p">,</span> <span class="n">util</span>

<span class="n">context</span> <span class="o">=</span> <span class="n">Interpolate</span><span class="p">(</span><span class="s2">&quot;buildbot/%(prop:buildername)s&quot;</span><span class="p">)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">GitHubStatusPush</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="s1">&#39;githubAPIToken&#39;</span><span class="p">,</span>
                                <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
                                <span class="n">startDescription</span><span class="o">=</span><span class="s1">&#39;Build started.&#39;</span><span class="p">,</span>
                                <span class="n">endDescription</span><span class="o">=</span><span class="s1">&#39;Build done.&#39;</span><span class="p">)</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">BuildFactory</span><span class="p">()</span>
<span class="n">buildbot_bbtools</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">BuilderConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;builder-name&#39;</span><span class="p">,</span>
    <span class="n">workernames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;worker1&#39;</span><span class="p">],</span>
    <span class="n">factory</span><span class="o">=</span><span class="n">factory</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;builders&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">buildbot_bbtools</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#GitHubStatusPush" title="GitHubStatusPush"><code class="xref py py-class docutils literal notranslate"><span class="pre">GitHubStatusPush</span></code></a> publishes a build status using <a class="reference external" href="http://developer.github.com/v3/repos/statuses">GitHub Status API</a>.</p>
<p>It requires <a class="reference external" href="https://pypi.python.org/pypi/txrequests">txrequests</a> package to allow interaction with GitHub REST API.</p>
<p>It is configured with at least a GitHub API token.</p>
<p>You can create a token from you own <a class="reference external" href="https://github.com/settings/applications">GitHub - Profile - Applications - Register new application</a> or use an external tool to generate one.</p>
<dl class="class">
<dt id="GitHubStatusPush">
<em class="property">class </em><code class="sig-name descname">GitHubStatusPush</code><span class="sig-paren">(</span><em class="sig-param">token</em>, <em class="sig-param">startDescription=None</em>, <em class="sig-param">endDescription=None</em>, <em class="sig-param">context=None</em>, <em class="sig-param">baseURL=None</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">builders=None</em><span class="sig-paren">)</span><a class="headerlink" href="#GitHubStatusPush" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token</strong> (<em>string</em>) – token used for authentication. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>string startDescription</strong> (<em>rendereable</em>) – Custom start message (default: ‘Build started.’)</p></li>
<li><p><strong>string endDescription</strong> (<em>rendereable</em>) – Custom end message (default: ‘Build done.’)</p></li>
<li><p><strong>string context</strong> (<em>rendereable</em>) – Passed to GitHub to differentiate between statuses.
A static string can be passed or <code class="xref py py-class docutils literal notranslate"><span class="pre">Interpolate</span></code> for dynamic substitution.
The default context is <cite>buildbot/%(prop:buildername)s</cite>.</p></li>
<li><p><strong>baseURL</strong> (<em>string</em>) – specify the github api endpoint if you work with GitHub Enterprise</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – if True, logs a message for each successful status push</p></li>
<li><p><strong>builders</strong> (<em>list</em>) – only send update for specified builders</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="githubcommentpush">
<h2><a class="toc-backref" href="#id54">GitHubCommentPush</a><a class="headerlink" href="#githubcommentpush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.github.GitHubCommentPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.github.</code><code class="sig-name descname">GitHubCommentPush</code><a class="headerlink" href="#buildbot.reporters.github.GitHubCommentPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span><span class="p">,</span> <span class="n">util</span>

<span class="n">gc</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">GitHubCommentPush</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="s1">&#39;githubAPIToken&#39;</span><span class="p">,</span>
                                 <span class="n">startDescription</span><span class="o">=</span><span class="s1">&#39;Build started.&#39;</span><span class="p">,</span>
                                 <span class="n">endDescription</span><span class="o">=</span><span class="s1">&#39;Build done.&#39;</span><span class="p">)</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">BuildFactory</span><span class="p">()</span>
<span class="n">buildbot_bbtools</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">BuilderConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;builder-name&#39;</span><span class="p">,</span>
    <span class="n">workernames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;worker1&#39;</span><span class="p">],</span>
    <span class="n">factory</span><span class="o">=</span><span class="n">factory</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;builders&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">buildbot_bbtools</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#GitHubCommentPush" title="GitHubCommentPush"><code class="xref py py-class docutils literal notranslate"><span class="pre">GitHubCommentPush</span></code></a> publishes a comment on a PR using <a class="reference external" href="https://developer.github.com/v3/pulls/comments/">GitHub Review Comments API</a>.</p>
<p>It requires <a class="reference external" href="https://pypi.python.org/pypi/txrequests">txrequests</a> package to allow interaction with GitHub REST API.</p>
<p>It is configured with at least a GitHub API token. By default, it will only comment at the end of a build unless a <code class="docutils literal notranslate"><span class="pre">startDescription</span></code> is provided.</p>
<p>You can create a token from you own <a class="reference external" href="https://github.com/settings/applications">GitHub - Profile - Applications - Register new application</a> or use an external tool to generate one.</p>
<dl class="class">
<dt id="GitHubCommentPush">
<em class="property">class </em><code class="sig-name descname">GitHubCommentPush</code><span class="sig-paren">(</span><em class="sig-param">token</em>, <em class="sig-param">startDescription=None</em>, <em class="sig-param">endDescription=None</em>, <em class="sig-param">baseURL=None</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">builders=None</em><span class="sig-paren">)</span><a class="headerlink" href="#GitHubCommentPush" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token</strong> (<em>string</em>) – token used for authentication. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>string startDescription</strong> (<em>rendereable</em>) – Custom start message (default: None)</p></li>
<li><p><strong>string endDescription</strong> (<em>rendereable</em>) – Custom end message (default: ‘Build done.’)</p></li>
<li><p><strong>baseURL</strong> (<em>string</em>) – specify the github api endpoint if you work with GitHub Enterprise</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – if True, logs a message for each successful status push</p></li>
<li><p><strong>builders</strong> (<em>list</em>) – only send update for specified builders</p></li>
<li><p><strong>verify</strong> (<em>boolean</em>) – disable ssl verification for the case you use temporary self signed certificates</p></li>
<li><p><strong>debug</strong> (<em>boolean</em>) – logs every requests and their response</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>string for comment, must be less than 65536 bytes.</p>
</dd>
</dl>
</dd></dl>

<p>Here’s a complete example of posting build results as a github comment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@util.renderer</span>
<span class="nd">@defer.inlineCallbacks</span>
<span class="k">def</span> <span class="nf">getresults</span><span class="p">(</span><span class="n">props</span><span class="p">):</span>
    <span class="n">all_logs</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">master</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">master</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">props</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="p">(</span><span class="s1">&#39;builders&#39;</span><span class="p">,</span> <span class="n">props</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s1">&#39;buildername&#39;</span><span class="p">),</span> <span class="s1">&#39;builds&#39;</span><span class="p">,</span>
        <span class="n">props</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s1">&#39;buildnumber&#39;</span><span class="p">),</span> <span class="s1">&#39;steps&#39;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">step</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">util</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;failure&#39;</span><span class="p">):</span>
            <span class="n">logs</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">master</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s2">&quot;steps&quot;</span><span class="p">,</span> <span class="n">step</span><span class="p">[</span><span class="s1">&#39;stepid&#39;</span><span class="p">],</span> <span class="s1">&#39;logs&#39;</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">logs</span><span class="p">:</span>
                <span class="n">all_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Step : {0} Result : {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                    <span class="n">step</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">util</span><span class="o">.</span><span class="n">Results</span><span class="p">[</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">]]))</span>
                <span class="n">all_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;```&#39;</span><span class="p">)</span>
                <span class="n">l</span><span class="p">[</span><span class="s1">&#39;stepname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">step</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">l</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">master</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s2">&quot;logs&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="s1">&#39;logid&#39;</span><span class="p">],</span> <span class="s1">&#39;contents&#39;</span><span class="p">))</span>
                <span class="n">step_logs</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">][</span><span class="s1">&#39;content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">include</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">step_logs</span><span class="p">):</span>
                    <span class="n">all_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sl</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="n">all_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;```&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">all_logs</span><span class="p">)</span>

<span class="n">gc</span> <span class="o">=</span> <span class="n">GitHubCommentPush</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="s1">&#39;githubAPIToken&#39;</span><span class="p">,</span>
                       <span class="n">endDescription</span><span class="o">=</span><span class="n">getresults</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="n">Interpolate</span><span class="p">(</span><span class="s1">&#39;buildbot/%(prop:buildername)s&#39;</span><span class="p">))</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="bitbucketserverstatuspush">
<h2><a class="toc-backref" href="#id55">BitbucketServerStatusPush</a><a class="headerlink" href="#bitbucketserverstatuspush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.BitbucketServer.BitbucketServerStatusPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.BitbucketServer.</code><code class="sig-name descname">BitbucketServerStatusPush</code><a class="headerlink" href="#buildbot.reporters.BitbucketServer.BitbucketServerStatusPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>

<span class="n">ss</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">BitbucketServerStatusPush</span><span class="p">(</span><span class="s1">&#39;https://bitbucketserver.example.com:8080/&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;bitbucketserver_username&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;secret_password&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#BitbucketServerStatusPush" title="BitbucketServerStatusPush"><code class="xref py py-class docutils literal notranslate"><span class="pre">BitbucketServerStatusPush</span></code></a> publishes build status using <a class="reference external" href="https://developer.atlassian.com/static/rest/bitbucket-server/5.1.0/bitbucket-build-rest.html#idm46185565214672">BitbucketServer Build Integration REST API</a>.
The build status is published to a specific commit SHA in Bitbucket Server.
It tracks the last build for each builderName for each commit built.</p>
<p>Specifically, it follows the <a class="reference external" href="https://developer.atlassian.com/stash/docs/latest/how-tos/updating-build-status-for-commits.html">Updating build status for commits</a> document.</p>
<p>It requires <a class="reference external" href="https://pypi.python.org/pypi/txrequests">txrequests</a> package to allow interaction with Bitbucket Server REST API.</p>
<p>It uses HTTP Basic AUTH.
As a result, we recommend you use https in your base_url rather than http.</p>
<dl class="class">
<dt id="BitbucketServerStatusPush">
<em class="property">class </em><code class="sig-name descname">BitbucketServerStatusPush</code><span class="sig-paren">(</span><em class="sig-param">base_url</em>, <em class="sig-param">user</em>, <em class="sig-param">password</em>, <em class="sig-param">key=None</em>, <em class="sig-param">statusName=None</em>, <em class="sig-param">startDescription=None</em>, <em class="sig-param">endDescription=None</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">builders=None</em><span class="sig-paren">)</span><a class="headerlink" href="#BitbucketServerStatusPush" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_url</strong> (<em>string</em>) – The base url of the Bitbucket Server host, up to and optionally including the first <cite>/</cite> of the path.</p></li>
<li><p><strong>user</strong> (<em>string</em>) – The Bitbucket Server user to post as. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>password</strong> (<em>string</em>) – The Bitbucket Server user’s password. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>string key</strong> (<em>renderable</em>) – Passed to Bitbucket Server to differentiate between statuses.
A static string can be passed or <code class="xref py py-class docutils literal notranslate"><span class="pre">Interpolate</span></code> for dynamic substitution.
The default key is <cite>%(prop:buildername)s</cite>.</p></li>
<li><p><strong>string statusName</strong> (<em>renderable</em>) – The name that is displayed for this status.
The default name is nothing, so Bitbucket Server will use the <code class="docutils literal notranslate"><span class="pre">key</span></code> parameter.</p></li>
<li><p><strong>string startDescription</strong> (<em>renderable</em>) – Custom start message (default: ‘Build started.’)</p></li>
<li><p><strong>string endDescription</strong> (<em>renderable</em>) – Custom end message (default: ‘Build done.’)</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – If True, logs a message for each successful status push.</p></li>
<li><p><strong>builders</strong> (<em>list</em>) – Only send update for specified builders.</p></li>
<li><p><strong>verify</strong> (<em>boolean</em>) – disable ssl verification for the case you use temporary self signed certificates</p></li>
<li><p><strong>debug</strong> (<em>boolean</em>) – logs every requests and their response</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="bitbucketserverprcommentpush">
<h2><a class="toc-backref" href="#id56">BitbucketServerPRCommentPush</a><a class="headerlink" href="#bitbucketserverprcommentpush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.BitbucketServer.BitbucketServerPRCommentPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.BitbucketServer.</code><code class="sig-name descname">BitbucketServerPRCommentPush</code><a class="headerlink" href="#buildbot.reporters.BitbucketServer.BitbucketServerPRCommentPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>

<span class="n">ss</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">BitbucketServerPRCommentPush</span><span class="p">(</span><span class="s1">&#39;https://bitbucket-server.example.com:8080/&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;bitbucket_server__username&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;secret_password&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">BitbucketServerPRCommentPush</span></code>  publishes a comment on a PR using <a class="reference external" href="https://developer.atlassian.com/static/rest/bitbucket-server/5.0.1/bitbucket-rest.html#idm45993793481168">Bitbucket Server REST API</a>.</p>
<dl class="class">
<dt>
<code class="sig-name descname">BitBucketServerPRCommentPush(base_url, user, password, messageFormatter=None, verbose=False, debug=None, verify=None, mode=('failing', 'passing', 'warnings'), tags=None, builders=None, schedulers=None, branches=None, buildSetSummary=False):</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_url</strong> (<em>string</em>) – The base url of the Bitbucket server host</p></li>
<li><p><strong>user</strong> (<em>string</em>) – The Bitbucket server user to post as. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>password</strong> (<em>string</em>) – The Bitbucket server user’s password. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>messageFormatter</strong> – This is an optional instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">MessageFormatter</span></code> that can be used to generate a custom comment.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – If True, logs a message for each successful status push.</p></li>
<li><p><strong>debug</strong> (<em>boolean</em>) – logs every requests and their response</p></li>
<li><p><strong>verify</strong> (<em>boolean</em>) – disable ssl verification for the case you use temporary self signed certificates</p></li>
<li><p><strong>mode</strong> (<em>list</em>) – <p>A list of strings which will determine the build status that will be reported.
The values could be <code class="docutils literal notranslate"><span class="pre">change</span></code>, <code class="docutils literal notranslate"><span class="pre">failing</span></code>, <code class="docutils literal notranslate"><span class="pre">passing</span></code>, <code class="docutils literal notranslate"><span class="pre">problem</span></code>, <code class="docutils literal notranslate"><span class="pre">warnings</span></code> or <code class="docutils literal notranslate"><span class="pre">exception</span></code>.
There are two shortcuts:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">all</span></code></dt><dd><p>Equivalent to (<code class="docutils literal notranslate"><span class="pre">change</span></code>, <code class="docutils literal notranslate"><span class="pre">failing</span></code>, <code class="docutils literal notranslate"><span class="pre">passing</span></code>, <code class="docutils literal notranslate"><span class="pre">problem</span></code>, <code class="docutils literal notranslate"><span class="pre">warnings</span></code>, <code class="docutils literal notranslate"><span class="pre">exception</span></code>)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">warnings</span></code></dt><dd><p>Equivalent to (<code class="docutils literal notranslate"><span class="pre">warnings</span></code>, <code class="docutils literal notranslate"><span class="pre">failing</span></code>).</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>tags</strong> (<em>list</em>) – A list of tag names to serve status information for.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> (all tags).
Use either builders or tags, but not both.</p></li>
<li><p><strong>builders</strong> (<em>list</em>) – Only send update for specified builders.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> (all builders).
Use either builders or tags, but not both</p></li>
<li><p><strong>schedulers</strong> (<em>list</em>) – A list of scheduler names to serve status information for.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> (all schedulers).</p></li>
<li><p><strong>branches</strong> (<em>list</em>) – A list of branch names to serve status information for.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> (all branches).</p></li>
<li><p><strong>buildSetSummary</strong> (<em>boolean</em>) – If true, post a comment when a build set is finished with all build completion messages in it, instead of doing it for each separate build.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This reporter depends on the Bitbucket server hook to get the pull request url.</p>
</div>
</div>
<div class="section" id="bitbucketstatuspush">
<h2><a class="toc-backref" href="#id57">BitbucketStatusPush</a><a class="headerlink" href="#bitbucketstatuspush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.bitbucket.BitbucketStatusPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.bitbucket.</code><code class="sig-name descname">BitbucketStatusPush</code><a class="headerlink" href="#buildbot.reporters.bitbucket.BitbucketStatusPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>
<span class="n">bs</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">BitbucketStatusPush</span><span class="p">(</span><span class="s1">&#39;oauth_key&#39;</span><span class="p">,</span> <span class="s1">&#39;oauth_secret&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#BitbucketStatusPush" title="BitbucketStatusPush"><code class="xref py py-class docutils literal notranslate"><span class="pre">BitbucketStatusPush</span></code></a> publishes build status using <a class="reference external" href="https://confluence.atlassian.com/bitbucket/buildstatus-resource-779295267.html">Bitbucket Build Status API</a>.
The build status is published to a specific commit SHA in Bitbucket.
It tracks the last build for each builderName for each commit built.</p>
<p>It requires <a class="reference external" href="https://pypi.python.org/pypi/txrequests">txrequests</a> package to allow interaction with the Bitbucket REST and OAuth APIs.</p>
<p>It uses OAuth 2.x to authenticate with Bitbucket.
To enable this, you need to go to your Bitbucket Settings -&gt; OAuth page.
Click “Add consumer”.
Give the new consumer a name, eg ‘buildbot’, and put in any URL as the callback (this is needed for Oauth 2.x but is not used by this reporter, eg ‘<a class="reference external" href="http://localhost:8010/callback">http://localhost:8010/callback</a>’).
Give the consumer Repositories:Write access.
After creating the consumer, you will then be able to see the OAuth key and secret.</p>
<dl class="class">
<dt id="BitbucketStatusPush">
<em class="property">class </em><code class="sig-name descname">BitbucketStatusPush</code><span class="sig-paren">(</span><em class="sig-param">oauth_key</em>, <em class="sig-param">oauth_secret</em>, <em class="sig-param">base_url='https://api.bitbucket.org/2.0/repositories'</em>, <em class="sig-param">oauth_url='https://bitbucket.org/site/oauth2/access_token'</em>, <em class="sig-param">builders=None</em><span class="sig-paren">)</span><a class="headerlink" href="#BitbucketStatusPush" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oauth_key</strong> (<em>string</em>) – The OAuth consumer key. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>oauth_secret</strong> (<em>string</em>) – The OAuth consumer secret. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>base_url</strong> (<em>string</em>) – Bitbucket’s Build Status API URL</p></li>
<li><p><strong>oauth_url</strong> (<em>string</em>) – Bitbucket’s OAuth API URL</p></li>
<li><p><strong>builders</strong> (<em>list</em>) – only send update for specified builders</p></li>
<li><p><strong>verify</strong> (<em>boolean</em>) – disable ssl verification for the case you use temporary self signed certificates</p></li>
<li><p><strong>debug</strong> (<em>boolean</em>) – logs every requests and their response</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="gitlabstatuspush">
<h2><a class="toc-backref" href="#id58">GitLabStatusPush</a><a class="headerlink" href="#gitlabstatuspush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.gitlab.GitLabStatusPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.gitlab.</code><code class="sig-name descname">GitLabStatusPush</code><a class="headerlink" href="#buildbot.reporters.gitlab.GitLabStatusPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>

<span class="n">gl</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">GitLabStatusPush</span><span class="p">(</span><span class="s1">&#39;private-token&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s1">&#39;continuous-integration/buildbot&#39;</span><span class="p">,</span>
                                <span class="n">baseURL</span><span class="o">=</span><span class="s1">&#39;https://git.yourcompany.com&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gl</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#GitLabStatusPush" title="GitLabStatusPush"><code class="xref py py-class docutils literal notranslate"><span class="pre">GitLabStatusPush</span></code></a> publishes build status using <a class="reference external" href="http://doc.gitlab.com/ce/api/commits.html#commit-status">GitLab Commit Status API</a>.
The build status is published to a specific commit SHA in GitLab.</p>
<p>It requires <a class="reference external" href="https://pypi.python.org/pypi/txrequests">txrequests</a> package to allow interaction with GitLab Commit Status API.</p>
<p>It uses private token auth, and the token owner is required to have at least developer access to each repository. As a result, we recommend you use https in your base_url rather than http.</p>
<dl class="class">
<dt id="GitLabStatusPush">
<em class="property">class </em><code class="sig-name descname">GitLabStatusPush</code><span class="sig-paren">(</span><em class="sig-param">token</em>, <em class="sig-param">startDescription=None</em>, <em class="sig-param">endDescription=None</em>, <em class="sig-param">context=None</em>, <em class="sig-param">baseURL=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#GitLabStatusPush" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token</strong> (<em>string</em>) – Private token of user permitted to update status for commits. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>startDescription</strong> (<em>string</em>) – Description used when build starts</p></li>
<li><p><strong>endDescription</strong> (<em>string</em>) – Description used when build ends</p></li>
<li><p><strong>context</strong> (<em>string</em>) – Name of your build system, eg. continuous-integration/buildbot</p></li>
<li><p><strong>baseURL</strong> (<em>string</em>) – the base url of the GitLab host, up to and optionally including the first <cite>/</cite> of the path. Do not include /api/</p></li>
<li><p><strong>verbose</strong> (<em>string</em>) – Be more verbose</p></li>
<li><p><strong>verify</strong> (<em>boolean</em>) – disable ssl verification for the case you use temporary self signed certificates</p></li>
<li><p><strong>debug</strong> (<em>boolean</em>) – logs every requests and their response</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="hipchatstatuspush">
<h2><a class="toc-backref" href="#id59">HipchatStatusPush</a><a class="headerlink" href="#hipchatstatuspush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.hipchat.HipchatStatusPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.hipchat.</code><code class="sig-name descname">HipchatStatusPush</code><a class="headerlink" href="#buildbot.reporters.hipchat.HipchatStatusPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>

<span class="n">hs</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">HipchatStatusPush</span><span class="p">(</span><span class="s1">&#39;private-token&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="s1">&#39;https://chat.yourcompany.com&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hs</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">HipchatStatusPush</span></code> publishes a custom message using <a class="reference external" href="https://www.hipchat.com/docs/apiv2">Hipchat API v2</a>.
The message is published to a user and/or room in Hipchat,</p>
<p>It requires <a class="reference external" href="https://pypi.python.org/pypi/txrequests">txrequests</a> package to allow interaction with Hipchat API.</p>
<p>It uses API token auth, and the token owner is required to have at least message/notification access to each destination.</p>
<dl class="class">
<dt>
<code class="sig-name descname">HipchatStatusPush(auth_token, endpoint=&quot;https://api.hipchat.com&quot;,</code></dt>
<dt>
<code class="sig-name descname">builder_room_map=None, builder_user_map=None,</code></dt>
<dt>
<code class="sig-name descname">wantProperties=False, wantSteps=False, wantPreviousBuild=False, wantLogs=False)</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>auth_token</strong> (<em>string</em>) – Private API token with access to the “Send Message” and “Send Notification” scopes. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)</p></li>
<li><p><strong>endpoint</strong> (<em>string</em>) – (optional) URL of your Hipchat server. Defaults to <a class="reference external" href="https://api.hipchat.com">https://api.hipchat.com</a></p></li>
<li><p><strong>builder_room_map</strong> (<em>dictionary</em>) – (optional) If specified, will forward events about a builder (based on name) to the corresponding room ID.</p></li>
<li><p><strong>builder_user_map</strong> (<em>dictionary</em>) – (optional) If specified, will forward events about a builder (based on name) to the corresponding user ID.</p></li>
<li><p><strong>wantProperties</strong> (<em>boolean</em>) – (optional) include ‘properties’ in the build dictionary</p></li>
<li><p><strong>wantSteps</strong> (<em>boolean</em>) – (optional) include ‘steps’ in the build dictionary</p></li>
<li><p><strong>wantLogs</strong> (<em>boolean</em>) – (optional) include ‘logs’ in the steps dictionaries.
This needs wantSteps=True.
This dumps the <em>full</em> content of logs.</p></li>
<li><p><strong>wantPreviousBuild</strong> (<em>boolean</em>) – (optional) include ‘prev_build’ in the build dictionary</p></li>
<li><p><strong>verify</strong> (<em>boolean</em>) – disable ssl verification for the case you use temporary self signed certificates</p></li>
<li><p><strong>debug</strong> (<em>boolean</em>) – logs every requests and their response</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No message will be sent if the message is empty or there is no destination found.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a builder name appears in both the room and user map, the same message will be sent to both destinations.</p>
</div>
<div class="section" id="id37">
<h3><a class="toc-backref" href="#id60">Json object spec</a><a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h3>
<p>The default json object contains the minimal required parameters to send a message to Hipchat.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Buildbot started/finished build MyBuilderName (with result success) here: http://mybuildbot.com/#/builders/23&quot;</span><span class="p">,</span>
    <span class="nt">&quot;id_or_email&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you require different parameters, the Hipchat reporter utilizes the template design pattern and will call <a class="reference internal" href="#getRecipientList" title="getRecipientList"><code class="xref py py-func docutils literal notranslate"><span class="pre">getRecipientList()</span></code></a> <a class="reference internal" href="#getMessage" title="getMessage"><code class="xref py py-func docutils literal notranslate"><span class="pre">getMessage()</span></code></a> <a class="reference internal" href="#getExtraParams" title="getExtraParams"><code class="xref py py-func docutils literal notranslate"><span class="pre">getExtraParams()</span></code></a>
before sending a message. This allows you to easily override the default implementation for those methods. All of those methods can be deferred.</p>
<p>Method signatures:</p>
<dl class="method">
<dt id="getRecipientList">
<code class="sig-name descname">getRecipientList</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">build</em>, <em class="sig-param">event_name</em><span class="sig-paren">)</span><a class="headerlink" href="#getRecipientList" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Build</span></code> object</p></li>
<li><p><strong>event_name</strong> (<em>string</em>) – the name of the event trigger for this invocation. either ‘new’ or ‘finished’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Deferred</p>
</dd>
</dl>
<p>The deferred should return a dictionary containing the key(s) ‘id_or_email’ for a private user message and/or
‘room_id_or_name’ for room notifications.</p>
</dd></dl>

<dl class="method">
<dt id="getMessage">
<code class="sig-name descname">getMessage</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">build</em>, <em class="sig-param">event_name</em><span class="sig-paren">)</span><a class="headerlink" href="#getMessage" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Build</span></code> object</p></li>
<li><p><strong>event_name</strong> (<em>string</em>) – the name of the event trigger for this invocation. either ‘new’ or ‘finished’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Deferred</p>
</dd>
</dl>
<p>The deferred should return a string to send to Hipchat.</p>
</dd></dl>

<dl class="method">
<dt id="getExtraParams">
<code class="sig-name descname">getExtraParams</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">build</em>, <em class="sig-param">event_name</em><span class="sig-paren">)</span><a class="headerlink" href="#getExtraParams" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Build</span></code> object</p></li>
<li><p><strong>event_name</strong> (<em>string</em>) – the name of the event trigger for this invocation. either ‘new’ or ‘finished’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Deferred</p>
</dd>
</dl>
<p>The deferred should return a dictionary containing any extra parameters you wish to include in your JSON POST
request that the Hipchat API can consume.</p>
</dd></dl>

<p>Here’s a complete example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyHipchatStatusPush</span><span class="p">(</span><span class="n">HipChatStatusPush</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;MyHipchatStatusPush&quot;</span>

    <span class="c1"># send all messages to the same room</span>
    <span class="k">def</span> <span class="nf">getRecipientList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">build</span><span class="p">,</span> <span class="n">event_name</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;room_id_or_name&#39;</span><span class="p">:</span> <span class="s1">&#39;AllBuildNotifications&#39;</span>
        <span class="p">}</span>

    <span class="c1"># only send notifications on finished events</span>
    <span class="k">def</span> <span class="nf">getMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">build</span><span class="p">,</span> <span class="n">event_name</span><span class="p">):</span>
        <span class="n">event_messages</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;finished&#39;</span><span class="p">:</span> <span class="s1">&#39;Build finished.&#39;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">event_messages</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># color notifications based on the build result</span>
    <span class="c1"># and alert room on build failure</span>
    <span class="k">def</span> <span class="nf">getExtraParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">build</span><span class="p">,</span> <span class="n">event_name</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">event_name</span> <span class="o">==</span> <span class="s1">&#39;finished&#39;</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">build</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;notify&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">build</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="gerritverifystatuspush">
<h2><a class="toc-backref" href="#id61">GerritVerifyStatusPush</a><a class="headerlink" href="#gerritverifystatuspush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.status.status_gerrit_verify_status.GerritVerifyStatusPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.status.status_gerrit_verify_status.</code><code class="sig-name descname">GerritVerifyStatusPush</code><a class="headerlink" href="#buildbot.status.status_gerrit_verify_status.GerritVerifyStatusPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><code class="xref py py-class docutils literal notranslate"><span class="pre">GerritVerifyStatusPush</span></code> sends a verify status to Gerrit using the <a class="reference external" href="https://gerrit.googlesource.com/plugins/verify-status">verify-status</a> Gerrit plugin.</p>
<p>It is an alternate method to <a href="#id38"><span class="problematic" id="id39">:bb:reporter:`GerritStatusPush`</span></a>, which uses the SSH API to send reviews.</p>
<p>The <a class="reference external" href="https://gerrit.googlesource.com/plugins/verify-status">verify-status</a> plugin allows several CI statuses to be sent for the same change, and display them separately in the Gerrit UI.</p>
<p>Most parameters are <span class="target" id="index-6"></span>renderables</p>
<dl class="class">
<dt>
<code class="sig-name descname">GerritVerifyStatusPush(</code></dt>
<dt>
<code class="sig-name descname">baseURL, auth,</code></dt>
<dt>
<code class="sig-name descname">startDescription=&quot;Build started.&quot;, endDescription=&quot;Build done.&quot;,</code></dt>
<dt>
<code class="sig-name descname">verification_name=Interpolate(&quot;%(prop:buildername)s&quot;), abstain=False, category=None, reporter=None,</code></dt>
<dt>
<code class="sig-name descname">verbose=False, **kwargs)</code></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>baseURL</strong> (<em>string</em>) – Gerrit HTTP base URL</p></li>
<li><p><strong>auth</strong> (<em>string</em>) – a requests authentication configuration. (can be a <a class="reference internal" href="../secretsmanagement.html#secret"><span class="std std-ref">Secret</span></a>)
if Gerrit is configured with <code class="docutils literal notranslate"><span class="pre">BasicAuth</span></code>, then it shall be <code class="docutils literal notranslate"><span class="pre">('login',</span> <span class="pre">'password')</span></code>
if Gerrit is configured with <code class="docutils literal notranslate"><span class="pre">DigestAuth</span></code>, then it shall be <code class="docutils literal notranslate"><span class="pre">requests.auth.HTTPDigestAuth('login',</span> <span class="pre">'password')</span></code> from the requests module.</p></li>
<li><p><strong>string startDescription</strong> (<em>renderable</em>) – the comment sent when the build is starting.</p></li>
<li><p><strong>string endDescription</strong> (<em>renderable</em>) – the comment sent when the build is finishing.</p></li>
<li><p><strong>string verification_name</strong> (<em>renderable</em>) – the name of the job displayed in the Gerrit UI.</p></li>
<li><p><strong>boolean abstain</strong> (<em>renderable</em>) – whether this results should be counted as voting.</p></li>
<li><p><strong>boolean category</strong> (<em>renderable</em>) – Category of the build.</p></li>
<li><p><strong>boolean reporter</strong> (<em>renderable</em>) – The user that verified this build</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Whether to log every requests.</p></li>
<li><p><strong>builders</strong> (<em>list</em>) – only send update for specified builders</p></li>
<li><p><strong>verify</strong> (<em>boolean</em>) – disable ssl verification for the case you use temporary self signed certificates</p></li>
<li><p><strong>debug</strong> (<em>boolean</em>) – logs every requests and their response</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>This reporter is integrated with <code class="xref py py-class docutils literal notranslate"><span class="pre">GerritChangeSource</span></code>, and will update changes detected by this change source.</p>
<p>This reporter can also send reports for changes triggered manually provided that there is a property in the build named <code class="docutils literal notranslate"><span class="pre">gerrit_changes</span></code>, containing the list of changes that were tested.
This property must be a list of dictionaries, containing <code class="docutils literal notranslate"><span class="pre">change_id</span></code> and <code class="docutils literal notranslate"><span class="pre">revision_id</span></code> keys, as defined in the revision endpoints of the <a class="reference external" href="https://gerrit-review.googlesource.com/Documentation/rest-api-changes.html#revision-endpoints">Gerrit documentation</a></p>
</div>
<div class="section" id="zulipstatuspush">
<h2><a class="toc-backref" href="#id62">ZulipStatusPush</a><a class="headerlink" href="#zulipstatuspush" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="buildbot.reporters.zulip.ZulipStatusPush">
<em class="property">class </em><code class="sig-prename descclassname">buildbot.reporters.zulip.</code><code class="sig-name descname">ZulipStatusPush</code><a class="headerlink" href="#buildbot.reporters.zulip.ZulipStatusPush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">buildbot.plugins</span> <span class="kn">import</span> <span class="n">reporters</span>

<span class="n">zs</span> <span class="o">=</span> <span class="n">reporters</span><span class="o">.</span><span class="n">ZulipStatusPush</span><span class="p">(</span><span class="n">endpoint</span><span class="o">=</span><span class="s1">&#39;your-organization@zulipchat.com&#39;</span><span class="p">,</span>
                               <span class="n">token</span><span class="o">=</span><span class="s1">&#39;private-token&#39;</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="s1">&#39;stream_to_post_in&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#ZulipStatusPush" title="ZulipStatusPush"><code class="xref py py-class docutils literal notranslate"><span class="pre">ZulipStatusPush</span></code></a> sends build status using <a class="reference external" href="https://zulipchat.com/api/">The Zulip API</a>.
The build status is sent to a user as a private message or in a stream in Zulip,</p>
<dl class="class">
<dt id="ZulipStatusPush">
<em class="property">class </em><code class="sig-name descname">ZulipStatusPush</code><span class="sig-paren">(</span><em class="sig-param">endpoint</em>, <em class="sig-param">token</em>, <em class="sig-param">stream=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ZulipStatusPush" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>endpoint</strong> (<em>string</em>) – URL of your Zulip server.</p></li>
<li><p><strong>token</strong> (<em>string</em>) – Private API token</p></li>
<li><p><strong>stream</strong> (<em>string</em>) – The stream in which the build status is to be sent. Defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A private message is sent if stream is set to None.</p>
</div>
<div class="section" id="id41">
<h3><a class="toc-backref" href="#id63">Json object spec</a><a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h3>
<p>The json object sent contains the following build status values.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;new/finished&quot;</span><span class="p">,</span>
    <span class="nt">&quot;buildid&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;buildid&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;buildername&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;builder name&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;URL to the build&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;project&quot;</span><span class="p">:</span> <span class="s2">&quot;name of the project&quot;</span><span class="p">,</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;timestamp at start/finish&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, junpengxu

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>